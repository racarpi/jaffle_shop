[0m19:04:23.705162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021187FA27B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002118A9C07D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002118A9C0690>]}


============================== 19:04:23.709131 | 4b58bc17-0887-42bb-9626-41a4a7178344 ==============================
[0m19:04:23.709131 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:04:23.710041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\rodrigo.carpi\\.dbt', 'log_path': 'C:\\Users\\rodrigo.carpi\\Documents\\Personal\\Estudio\\dbt\\jaffle_shop\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:04:23.731153 [info ] [MainThread]: dbt version: 1.8.9
[0m19:04:23.732281 [info ] [MainThread]: python version: 3.13.0
[0m19:04:23.733146 [info ] [MainThread]: python path: C:\Users\rodrigo.carpi\Documents\Personal\py-ambientes\dbt-test-env\Scripts\python.exe
[0m19:04:23.734014 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m19:04:23.877826 [info ] [MainThread]: Using profiles dir at C:\Users\rodrigo.carpi\.dbt
[0m19:04:23.878732 [info ] [MainThread]: Using profiles.yml file at C:\Users\rodrigo.carpi\.dbt\profiles.yml
[0m19:04:23.879441 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\rodrigo.carpi\Documents\Personal\Estudio\dbt\jaffle_shop\dbt_project.yml
[0m19:04:23.880500 [info ] [MainThread]: adapter type: postgres
[0m19:04:23.881075 [info ] [MainThread]: adapter version: 1.8.2
[0m19:04:23.956171 [info ] [MainThread]: Configuration:
[0m19:04:23.956993 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:04:23.957657 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:04:23.958167 [info ] [MainThread]: Required dependencies:
[0m19:04:23.958843 [debug] [MainThread]: Executing "git --help"
[0m19:04:24.018369 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:04:24.018946 [debug] [MainThread]: STDERR: "b''"
[0m19:04:24.019414 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:04:24.020416 [info ] [MainThread]: Connection:
[0m19:04:24.021086 [info ] [MainThread]:   host: localhost
[0m19:04:24.021632 [info ] [MainThread]:   port: 5432
[0m19:04:24.022133 [info ] [MainThread]:   user: postgres
[0m19:04:24.022647 [info ] [MainThread]:   database: jaffle_shop
[0m19:04:24.023179 [info ] [MainThread]:   schema: test
[0m19:04:24.023673 [info ] [MainThread]:   connect_timeout: 10
[0m19:04:24.024201 [info ] [MainThread]:   role: None
[0m19:04:24.024721 [info ] [MainThread]:   search_path: None
[0m19:04:24.025329 [info ] [MainThread]:   keepalives_idle: 0
[0m19:04:24.025837 [info ] [MainThread]:   sslmode: None
[0m19:04:24.026333 [info ] [MainThread]:   sslcert: None
[0m19:04:24.026824 [info ] [MainThread]:   sslkey: None
[0m19:04:24.027317 [info ] [MainThread]:   sslrootcert: None
[0m19:04:24.027810 [info ] [MainThread]:   application_name: dbt
[0m19:04:24.028302 [info ] [MainThread]:   retries: 1
[0m19:04:24.029045 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:04:24.311397 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:04:24.387281 [debug] [MainThread]: Using postgres connection "debug"
[0m19:04:24.387668 [debug] [MainThread]: On debug: select 1 as id
[0m19:04:24.387925 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:04:24.489784 [debug] [MainThread]: SQL status: SELECT 1 in 0.102 seconds
[0m19:04:24.491072 [debug] [MainThread]: On debug: Close
[0m19:04:24.491443 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:04:24.492646 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:04:24.494017 [debug] [MainThread]: Command `dbt debug` succeeded at 19:04:24.493833 after 0.91 seconds
[0m19:04:24.494360 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:04:24.494684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002118B299350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002118B18B530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002118B0C07C0>]}
[0m19:04:24.495067 [debug] [MainThread]: Flushing usage events
[0m19:19:41.894248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002122F1EEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002122EE7B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021231C147D0>]}


============================== 19:19:41.899032 | 4cf6c9f8-d3d0-408a-b373-9f30e15ca4a8 ==============================
[0m19:19:41.899032 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:19:41.899629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\rodrigo.carpi\\Documents\\Personal\\Estudio\\dbt\\jaffle_shop\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\rodrigo.carpi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:19:42.141363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cf6c9f8-d3d0-408a-b373-9f30e15ca4a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212322AA520>]}
[0m19:19:42.188459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4cf6c9f8-d3d0-408a-b373-9f30e15ca4a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021231BF67A0>]}
[0m19:19:42.189559 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:19:42.512788 [debug] [MainThread]: checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, vars: {}, profile: , target: dev, version: 1.8.9
[0m19:19:42.549640 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:19:42.550119 [debug] [MainThread]: previous checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, current checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1
[0m19:19:42.550492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4cf6c9f8-d3d0-408a-b373-9f30e15ca4a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002123219FE50>]}
[0m19:19:43.453842 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.example
[0m19:19:43.458842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cf6c9f8-d3d0-408a-b373-9f30e15ca4a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212321D4500>]}
[0m19:19:43.546711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cf6c9f8-d3d0-408a-b373-9f30e15ca4a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212322951D0>]}
[0m19:19:43.547219 [info ] [MainThread]: Found 1 model, 428 macros
[0m19:19:43.548823 [info ] [MainThread]: 
[0m19:19:43.549425 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:19:43.550550 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m19:19:43.653004 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m19:19:43.653436 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m19:19:43.653720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:43.762780 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.109 seconds
[0m19:19:43.764301 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m19:19:43.765526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_test)
[0m19:19:43.766286 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "test"
"
[0m19:19:43.771673 [debug] [ThreadPool]: Using postgres connection "create_jaffle_shop_test"
[0m19:19:43.772089 [debug] [ThreadPool]: On create_jaffle_shop_test: BEGIN
[0m19:19:43.772392 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:19:43.887794 [debug] [ThreadPool]: SQL status: BEGIN in 0.115 seconds
[0m19:19:43.888189 [debug] [ThreadPool]: Using postgres connection "create_jaffle_shop_test"
[0m19:19:43.888446 [debug] [ThreadPool]: On create_jaffle_shop_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_test"} */
create schema if not exists "test"
[0m19:19:43.889924 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m19:19:43.891913 [debug] [ThreadPool]: On create_jaffle_shop_test: COMMIT
[0m19:19:43.892360 [debug] [ThreadPool]: Using postgres connection "create_jaffle_shop_test"
[0m19:19:43.892607 [debug] [ThreadPool]: On create_jaffle_shop_test: COMMIT
[0m19:19:43.893824 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m19:19:43.894198 [debug] [ThreadPool]: On create_jaffle_shop_test: Close
[0m19:19:43.896225 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop_test'
[0m19:19:43.902218 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_test"
[0m19:19:43.902627 [debug] [ThreadPool]: On list_jaffle_shop_test: BEGIN
[0m19:19:43.902882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:44.018944 [debug] [ThreadPool]: SQL status: BEGIN in 0.116 seconds
[0m19:19:44.019442 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_test"
[0m19:19:44.019745 [debug] [ThreadPool]: On list_jaffle_shop_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_test"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'test'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'test'
    union all
    select
      'jaffle_shop' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'test'
  
[0m19:19:44.023877 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m19:19:44.026020 [debug] [ThreadPool]: On list_jaffle_shop_test: ROLLBACK
[0m19:19:44.026759 [debug] [ThreadPool]: On list_jaffle_shop_test: Close
[0m19:19:44.031279 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:44.031649 [debug] [MainThread]: On master: BEGIN
[0m19:19:44.031893 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:19:44.132310 [debug] [MainThread]: SQL status: BEGIN in 0.100 seconds
[0m19:19:44.132790 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:44.133126 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:19:44.138304 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m19:19:44.140012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cf6c9f8-d3d0-408a-b373-9f30e15ca4a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021233C08460>]}
[0m19:19:44.140428 [debug] [MainThread]: On master: ROLLBACK
[0m19:19:44.141014 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:44.141307 [debug] [MainThread]: On master: BEGIN
[0m19:19:44.142075 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:19:44.142396 [debug] [MainThread]: On master: COMMIT
[0m19:19:44.142658 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:44.142901 [debug] [MainThread]: On master: COMMIT
[0m19:19:44.143319 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:19:44.143613 [debug] [MainThread]: On master: Close
[0m19:19:44.144038 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:19:44.144355 [info ] [MainThread]: 
[0m19:19:44.148026 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_jaffle_shop__customers
[0m19:19:44.148597 [info ] [Thread-1 (]: 1 of 1 START sql view model test.stg_jaffle_shop__customers .................... [RUN]
[0m19:19:44.149106 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_jaffle_shop__customers'
[0m19:19:44.149421 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_jaffle_shop__customers
[0m19:19:44.155362 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:19:44.157284 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_jaffle_shop__customers
[0m19:19:44.191612 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:19:44.193958 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:19:44.194692 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: BEGIN
[0m19:19:44.195014 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:19:44.313779 [debug] [Thread-1 (]: SQL status: BEGIN in 0.119 seconds
[0m19:19:44.314234 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:19:44.314545 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__customers"} */

  create view "jaffle_shop"."test"."stg_jaffle_shop__customers__dbt_tmp"
    
    
  as (
    select
     trim(id)   as id
    ,trim(name) as name
from source.customers
  );
[0m19:19:44.317275 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no existe la relaciÃ³n Â«source.customersÂ»
LINE 10: from source.customers
              ^
[0m19:19:44.317845 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: ROLLBACK
[0m19:19:44.319093 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: Close
[0m19:19:44.326401 [debug] [Thread-1 (]: Database Error in model stg_jaffle_shop__customers (models\staging\stg_jaffle_shop__customers.sql)
  no existe la relaciÃ³n Â«source.customersÂ»
  LINE 10: from source.customers
                ^
  compiled code at target\run\jaffle_shop\models\staging\stg_jaffle_shop__customers.sql
[0m19:19:44.327764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cf6c9f8-d3d0-408a-b373-9f30e15ca4a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021233B78110>]}
[0m19:19:44.328380 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model test.stg_jaffle_shop__customers ........... [[31mERROR[0m in 0.18s]
[0m19:19:44.329011 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_jaffle_shop__customers
[0m19:19:44.330813 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:44.331188 [debug] [MainThread]: On master: BEGIN
[0m19:19:44.331433 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:19:44.441016 [debug] [MainThread]: SQL status: BEGIN in 0.109 seconds
[0m19:19:44.441945 [debug] [MainThread]: On master: COMMIT
[0m19:19:44.442324 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:44.442565 [debug] [MainThread]: On master: COMMIT
[0m19:19:44.443068 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:19:44.443376 [debug] [MainThread]: On master: Close
[0m19:19:44.443783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:19:44.444039 [debug] [MainThread]: Connection 'create_jaffle_shop_test' was properly closed.
[0m19:19:44.444258 [debug] [MainThread]: Connection 'list_jaffle_shop_test' was properly closed.
[0m19:19:44.444489 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_jaffle_shop__customers' was properly closed.
[0m19:19:44.444796 [info ] [MainThread]: 
[0m19:19:44.445130 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m19:19:44.445786 [debug] [MainThread]: Command end result
[0m19:19:44.470379 [info ] [MainThread]: 
[0m19:19:44.471045 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:19:44.471436 [info ] [MainThread]: 
[0m19:19:44.471844 [error] [MainThread]:   Database Error in model stg_jaffle_shop__customers (models\staging\stg_jaffle_shop__customers.sql)
  no existe la relaciÃ³n Â«source.customersÂ»
  LINE 10: from source.customers
                ^
  compiled code at target\run\jaffle_shop\models\staging\stg_jaffle_shop__customers.sql
[0m19:19:44.472210 [info ] [MainThread]: 
[0m19:19:44.472547 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:19:44.473757 [debug] [MainThread]: Command `cli build` failed at 19:19:44.473509 after 2.71 seconds
[0m19:19:44.474445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212336C0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002122E0E4D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021233B0FED0>]}
[0m19:19:44.475027 [debug] [MainThread]: Flushing usage events
[0m19:21:50.381747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020634D22660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020637778550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002063769F750>]}


============================== 19:21:50.385592 | bf03f3f8-68c8-4448-96e0-4ec2d20599f2 ==============================
[0m19:21:50.385592 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:21:50.386938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\rodrigo.carpi\\Documents\\Personal\\Estudio\\dbt\\jaffle_shop\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\rodrigo.carpi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:21:50.405709 [info ] [MainThread]: dbt version: 1.8.9
[0m19:21:50.406659 [info ] [MainThread]: python version: 3.13.0
[0m19:21:50.407557 [info ] [MainThread]: python path: C:\Users\rodrigo.carpi\Documents\Personal\py-ambientes\dbt-test-env\Scripts\python.exe
[0m19:21:50.408453 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m19:21:50.553731 [info ] [MainThread]: Using profiles dir at C:\Users\rodrigo.carpi\.dbt
[0m19:21:50.555150 [info ] [MainThread]: Using profiles.yml file at C:\Users\rodrigo.carpi\.dbt\profiles.yml
[0m19:21:50.556113 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\rodrigo.carpi\Documents\Personal\Estudio\dbt\jaffle_shop\dbt_project.yml
[0m19:21:50.558096 [info ] [MainThread]: adapter type: postgres
[0m19:21:50.558781 [info ] [MainThread]: adapter version: 1.8.2
[0m19:21:50.634930 [info ] [MainThread]: Configuration:
[0m19:21:50.636244 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:21:50.636956 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:21:50.637527 [info ] [MainThread]: Required dependencies:
[0m19:21:50.638084 [debug] [MainThread]: Executing "git --help"
[0m19:21:50.704270 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:21:50.704781 [debug] [MainThread]: STDERR: "b''"
[0m19:21:50.705122 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:21:50.705855 [info ] [MainThread]: Connection:
[0m19:21:50.706449 [info ] [MainThread]:   host: localhost
[0m19:21:50.707047 [info ] [MainThread]:   port: 5432
[0m19:21:50.707514 [info ] [MainThread]:   user: postgres
[0m19:21:50.708004 [info ] [MainThread]:   database: dbt
[0m19:21:50.708479 [info ] [MainThread]:   schema: test
[0m19:21:50.708952 [info ] [MainThread]:   connect_timeout: 10
[0m19:21:50.709421 [info ] [MainThread]:   role: None
[0m19:21:50.709885 [info ] [MainThread]:   search_path: None
[0m19:21:50.710355 [info ] [MainThread]:   keepalives_idle: 0
[0m19:21:50.710840 [info ] [MainThread]:   sslmode: None
[0m19:21:50.711554 [info ] [MainThread]:   sslcert: None
[0m19:21:50.712388 [info ] [MainThread]:   sslkey: None
[0m19:21:50.713039 [info ] [MainThread]:   sslrootcert: None
[0m19:21:50.713911 [info ] [MainThread]:   application_name: dbt
[0m19:21:50.714629 [info ] [MainThread]:   retries: 1
[0m19:21:50.715451 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:21:51.025518 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:21:51.115906 [debug] [MainThread]: Using postgres connection "debug"
[0m19:21:51.116288 [debug] [MainThread]: On debug: select 1 as id
[0m19:21:51.116541 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:21:51.220213 [debug] [MainThread]: SQL status: SELECT 1 in 0.104 seconds
[0m19:21:51.221192 [debug] [MainThread]: On debug: Close
[0m19:21:51.221567 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:21:51.222518 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:21:51.223994 [debug] [MainThread]: Command `dbt debug` succeeded at 19:21:51.223796 after 0.96 seconds
[0m19:21:51.224353 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:21:51.224669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020638FC9350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020637EE3530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020637E24380>]}
[0m19:21:51.225016 [debug] [MainThread]: Flushing usage events
[0m19:23:35.788896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270D3FEEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270D3C7B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270D6A147D0>]}


============================== 19:23:35.792810 | 31792610-a3bd-4f2f-982f-0aeb3ae6a693 ==============================
[0m19:23:35.792810 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:23:35.793351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\rodrigo.carpi\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\rodrigo.carpi\\Documents\\Personal\\Estudio\\dbt\\jaffle_shop\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:23:36.033515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31792610-a3bd-4f2f-982f-0aeb3ae6a693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270D712A520>]}
[0m19:23:36.080845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31792610-a3bd-4f2f-982f-0aeb3ae6a693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270D69F68B0>]}
[0m19:23:36.081968 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:23:36.370309 [debug] [MainThread]: checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, vars: {}, profile: , target: dev, version: 1.8.9
[0m19:23:36.421586 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:23:36.422060 [debug] [MainThread]: previous checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, current checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1
[0m19:23:36.422352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '31792610-a3bd-4f2f-982f-0aeb3ae6a693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270D701FE50>]}
[0m19:23:37.279736 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.example
[0m19:23:37.284331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31792610-a3bd-4f2f-982f-0aeb3ae6a693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270D7056F30>]}
[0m19:23:37.355802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31792610-a3bd-4f2f-982f-0aeb3ae6a693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270D7115C50>]}
[0m19:23:37.356446 [info ] [MainThread]: Found 1 model, 428 macros
[0m19:23:37.356825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31792610-a3bd-4f2f-982f-0aeb3ae6a693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270D833E1A0>]}
[0m19:23:37.358268 [info ] [MainThread]: 
[0m19:23:37.358889 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:23:37.359964 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m19:23:37.446951 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m19:23:37.447358 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m19:23:37.447628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:37.567368 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.120 seconds
[0m19:23:37.568877 [debug] [ThreadPool]: On list_dbt: Close
[0m19:23:37.570465 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_test)
[0m19:23:37.571223 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "test"
"
[0m19:23:37.575895 [debug] [ThreadPool]: Using postgres connection "create_dbt_test"
[0m19:23:37.576271 [debug] [ThreadPool]: On create_dbt_test: BEGIN
[0m19:23:37.576547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:23:37.670410 [debug] [ThreadPool]: SQL status: BEGIN in 0.094 seconds
[0m19:23:37.670814 [debug] [ThreadPool]: Using postgres connection "create_dbt_test"
[0m19:23:37.671081 [debug] [ThreadPool]: On create_dbt_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_dbt_test"} */
create schema if not exists "test"
[0m19:23:37.673602 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m19:23:37.675056 [debug] [ThreadPool]: On create_dbt_test: COMMIT
[0m19:23:37.675363 [debug] [ThreadPool]: Using postgres connection "create_dbt_test"
[0m19:23:37.675612 [debug] [ThreadPool]: On create_dbt_test: COMMIT
[0m19:23:37.676945 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m19:23:37.677358 [debug] [ThreadPool]: On create_dbt_test: Close
[0m19:23:37.679017 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m19:23:37.684322 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m19:23:37.684719 [debug] [ThreadPool]: On list_dbt_test: BEGIN
[0m19:23:37.685003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:37.802749 [debug] [ThreadPool]: SQL status: BEGIN in 0.118 seconds
[0m19:23:37.803248 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m19:23:37.803528 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_test"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'test'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'test'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'test'
  
[0m19:23:37.809995 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m19:23:37.811770 [debug] [ThreadPool]: On list_dbt_test: ROLLBACK
[0m19:23:37.812373 [debug] [ThreadPool]: On list_dbt_test: Close
[0m19:23:37.816507 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:37.816892 [debug] [MainThread]: On master: BEGIN
[0m19:23:37.817146 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:23:37.923134 [debug] [MainThread]: SQL status: BEGIN in 0.106 seconds
[0m19:23:37.923662 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:37.924344 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:23:37.932415 [debug] [MainThread]: SQL status: SELECT 6 in 0.008 seconds
[0m19:23:37.933801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31792610-a3bd-4f2f-982f-0aeb3ae6a693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270D85774D0>]}
[0m19:23:37.934217 [debug] [MainThread]: On master: ROLLBACK
[0m19:23:37.935007 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:37.935377 [debug] [MainThread]: On master: BEGIN
[0m19:23:37.936520 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:23:37.936916 [debug] [MainThread]: On master: COMMIT
[0m19:23:37.937184 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:37.937430 [debug] [MainThread]: On master: COMMIT
[0m19:23:37.937860 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:23:37.938165 [debug] [MainThread]: On master: Close
[0m19:23:37.938586 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:23:37.938895 [info ] [MainThread]: 
[0m19:23:37.941967 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_jaffle_shop__customers
[0m19:23:37.942545 [info ] [Thread-1 (]: 1 of 1 START sql view model test.stg_jaffle_shop__customers .................... [RUN]
[0m19:23:37.943078 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_jaffle_shop__customers'
[0m19:23:37.943403 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_jaffle_shop__customers
[0m19:23:37.949154 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:23:37.950129 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_jaffle_shop__customers
[0m19:23:37.987688 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:23:37.988712 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:23:37.989123 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: BEGIN
[0m19:23:37.989443 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:23:38.086527 [debug] [Thread-1 (]: SQL status: BEGIN in 0.097 seconds
[0m19:23:38.086987 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:23:38.087318 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__customers"} */

  create view "dbt"."test"."stg_jaffle_shop__customers__dbt_tmp"
    
    
  as (
    select
     trim(id)   as id
    ,trim(name) as name
from source.customers
  );
[0m19:23:38.089924 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:23:38.096405 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:23:38.096837 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__customers"} */
alter table "dbt"."test"."stg_jaffle_shop__customers__dbt_tmp" rename to "stg_jaffle_shop__customers"
[0m19:23:38.097888 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:23:38.111562 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: COMMIT
[0m19:23:38.112003 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:23:38.112317 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: COMMIT
[0m19:23:38.114036 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:23:38.119579 [debug] [Thread-1 (]: Applying DROP to: "dbt"."test"."stg_jaffle_shop__customers__dbt_backup"
[0m19:23:38.124427 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:23:38.124854 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__customers"} */
drop view if exists "dbt"."test"."stg_jaffle_shop__customers__dbt_backup" cascade
[0m19:23:38.125692 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:23:38.127912 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: Close
[0m19:23:38.129314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31792610-a3bd-4f2f-982f-0aeb3ae6a693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270D854AAF0>]}
[0m19:23:38.129979 [info ] [Thread-1 (]: 1 of 1 OK created sql view model test.stg_jaffle_shop__customers ............... [[32mCREATE VIEW[0m in 0.19s]
[0m19:23:38.130601 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_jaffle_shop__customers
[0m19:23:38.132195 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:38.132570 [debug] [MainThread]: On master: BEGIN
[0m19:23:38.132827 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:23:38.237772 [debug] [MainThread]: SQL status: BEGIN in 0.105 seconds
[0m19:23:38.238177 [debug] [MainThread]: On master: COMMIT
[0m19:23:38.238444 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:38.238692 [debug] [MainThread]: On master: COMMIT
[0m19:23:38.239134 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:23:38.239458 [debug] [MainThread]: On master: Close
[0m19:23:38.239863 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:38.240107 [debug] [MainThread]: Connection 'create_dbt_test' was properly closed.
[0m19:23:38.240343 [debug] [MainThread]: Connection 'list_dbt_test' was properly closed.
[0m19:23:38.240560 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_jaffle_shop__customers' was properly closed.
[0m19:23:38.240869 [info ] [MainThread]: 
[0m19:23:38.241178 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m19:23:38.241824 [debug] [MainThread]: Command end result
[0m19:23:38.266734 [info ] [MainThread]: 
[0m19:23:38.267240 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:23:38.267650 [info ] [MainThread]: 
[0m19:23:38.268078 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:23:38.269517 [debug] [MainThread]: Command `cli run` succeeded at 19:23:38.269245 after 2.59 seconds
[0m19:23:38.270120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270D87D1450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270D871FEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270D85512D0>]}
[0m19:23:38.270583 [debug] [MainThread]: Flushing usage events
[0m19:24:53.452314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179FE5CEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179FE25B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179810347D0>]}


============================== 19:24:53.456269 | 9527a306-b2e8-4570-a662-107760ea7bfa ==============================
[0m19:24:53.456269 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:24:53.456806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\rodrigo.carpi\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\rodrigo.carpi\\Documents\\Personal\\Estudio\\dbt\\jaffle_shop\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:24:53.697566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9527a306-b2e8-4570-a662-107760ea7bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001798170A520>]}
[0m19:24:53.744610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9527a306-b2e8-4570-a662-107760ea7bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179810168B0>]}
[0m19:24:53.745780 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:24:54.046368 [debug] [MainThread]: checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, vars: {}, profile: , target: dev, version: 1.8.9
[0m19:24:54.097988 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:24:54.098451 [debug] [MainThread]: previous checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, current checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1
[0m19:24:54.098742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9527a306-b2e8-4570-a662-107760ea7bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179815FBE50>]}
[0m19:24:54.960153 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.example
[0m19:24:54.965200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9527a306-b2e8-4570-a662-107760ea7bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017981636F30>]}
[0m19:24:55.034102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9527a306-b2e8-4570-a662-107760ea7bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179816F5D30>]}
[0m19:24:55.034611 [info ] [MainThread]: Found 2 models, 428 macros
[0m19:24:55.035015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9527a306-b2e8-4570-a662-107760ea7bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001798293A1A0>]}
[0m19:24:55.036480 [info ] [MainThread]: 
[0m19:24:55.037141 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:24:55.038267 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m19:24:55.123603 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m19:24:55.124005 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m19:24:55.124339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:55.228608 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.104 seconds
[0m19:24:55.230389 [debug] [ThreadPool]: On list_dbt: Close
[0m19:24:55.234640 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m19:24:55.239752 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m19:24:55.240145 [debug] [ThreadPool]: On list_dbt_test: BEGIN
[0m19:24:55.240415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:55.346441 [debug] [ThreadPool]: SQL status: BEGIN in 0.106 seconds
[0m19:24:55.346847 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m19:24:55.347141 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_test"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'test'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'test'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'test'
  
[0m19:24:55.351249 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m19:24:55.352657 [debug] [ThreadPool]: On list_dbt_test: ROLLBACK
[0m19:24:55.353272 [debug] [ThreadPool]: On list_dbt_test: Close
[0m19:24:55.358242 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:55.358629 [debug] [MainThread]: On master: BEGIN
[0m19:24:55.358880 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:24:55.477881 [debug] [MainThread]: SQL status: BEGIN in 0.119 seconds
[0m19:24:55.478653 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:55.479058 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:24:55.487035 [debug] [MainThread]: SQL status: SELECT 7 in 0.007 seconds
[0m19:24:55.488749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9527a306-b2e8-4570-a662-107760ea7bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017982B0B590>]}
[0m19:24:55.489157 [debug] [MainThread]: On master: ROLLBACK
[0m19:24:55.489725 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:55.490022 [debug] [MainThread]: On master: BEGIN
[0m19:24:55.490787 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:24:55.491105 [debug] [MainThread]: On master: COMMIT
[0m19:24:55.491366 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:55.491614 [debug] [MainThread]: On master: COMMIT
[0m19:24:55.492021 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:24:55.492310 [debug] [MainThread]: On master: Close
[0m19:24:55.492730 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:24:55.493050 [info ] [MainThread]: 
[0m19:24:55.496871 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_jaffle_shop__orders
[0m19:24:55.497488 [info ] [Thread-1 (]: 1 of 1 START sql view model test.stg_jaffle_shop__orders ....................... [RUN]
[0m19:24:55.498031 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_jaffle_shop__orders'
[0m19:24:55.498359 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_jaffle_shop__orders
[0m19:24:55.504215 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_jaffle_shop__orders"
[0m19:24:55.505234 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_jaffle_shop__orders
[0m19:24:55.540124 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_jaffle_shop__orders"
[0m19:24:55.541186 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__orders"
[0m19:24:55.541609 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: BEGIN
[0m19:24:55.541928 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:24:55.639300 [debug] [Thread-1 (]: SQL status: BEGIN in 0.097 seconds
[0m19:24:55.639755 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__orders"
[0m19:24:55.640104 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__orders"} */

  create view "dbt"."test"."stg_jaffle_shop__orders__dbt_tmp"
    
    
  as (
    select
     trim(id)                               as id
    ,trim(customer)                         as customer_id
    ,cast(trim(ordered_at) as timestamp)    as ordered_at
    ,trim(store_id)                         as store_id
    ,cast(trim(subtotal) as integer)        as subtotal
    ,cast(trim(tax_paid) as integer)        as tax_paid
    ,cast(trim(order_total) as integer)     as order_total
from source.orders
  );
[0m19:24:55.643359 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:24:55.649431 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__orders"
[0m19:24:55.649871 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__orders"} */
alter table "dbt"."test"."stg_jaffle_shop__orders__dbt_tmp" rename to "stg_jaffle_shop__orders"
[0m19:24:55.650917 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:24:55.664710 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: COMMIT
[0m19:24:55.665167 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__orders"
[0m19:24:55.665475 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: COMMIT
[0m19:24:55.667165 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:24:55.672756 [debug] [Thread-1 (]: Applying DROP to: "dbt"."test"."stg_jaffle_shop__orders__dbt_backup"
[0m19:24:55.677568 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__orders"
[0m19:24:55.678022 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__orders"} */
drop view if exists "dbt"."test"."stg_jaffle_shop__orders__dbt_backup" cascade
[0m19:24:55.678859 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:24:55.682084 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: Close
[0m19:24:55.683625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9527a306-b2e8-4570-a662-107760ea7bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017982B2A8E0>]}
[0m19:24:55.684343 [info ] [Thread-1 (]: 1 of 1 OK created sql view model test.stg_jaffle_shop__orders .................. [[32mCREATE VIEW[0m in 0.18s]
[0m19:24:55.685127 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_jaffle_shop__orders
[0m19:24:55.686546 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:55.686941 [debug] [MainThread]: On master: BEGIN
[0m19:24:55.687214 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:24:55.791882 [debug] [MainThread]: SQL status: BEGIN in 0.105 seconds
[0m19:24:55.792297 [debug] [MainThread]: On master: COMMIT
[0m19:24:55.792560 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:55.792814 [debug] [MainThread]: On master: COMMIT
[0m19:24:55.793429 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:24:55.794089 [debug] [MainThread]: On master: Close
[0m19:24:55.794570 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:24:55.794822 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m19:24:55.795055 [debug] [MainThread]: Connection 'list_dbt_test' was properly closed.
[0m19:24:55.795283 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_jaffle_shop__orders' was properly closed.
[0m19:24:55.795633 [info ] [MainThread]: 
[0m19:24:55.795997 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m19:24:55.796868 [debug] [MainThread]: Command end result
[0m19:24:55.821924 [info ] [MainThread]: 
[0m19:24:55.822446 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:24:55.822855 [info ] [MainThread]: 
[0m19:24:55.823274 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:24:55.824404 [debug] [MainThread]: Command `cli run` succeeded at 19:24:55.824206 after 2.48 seconds
[0m19:24:55.824801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017982EAF7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001798292F5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179816E3550>]}
[0m19:24:55.825139 [debug] [MainThread]: Flushing usage events
[0m19:25:27.979260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB16C2EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB168BB890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB196547D0>]}


============================== 19:25:27.983314 | 34059f64-21ee-4c4a-9b26-915e83d14ebf ==============================
[0m19:25:27.983314 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:25:27.983854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\rodrigo.carpi\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\rodrigo.carpi\\Documents\\Personal\\Estudio\\dbt\\jaffle_shop\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:25:28.224670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34059f64-21ee-4c4a-9b26-915e83d14ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB19CEA520>]}
[0m19:25:28.271513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34059f64-21ee-4c4a-9b26-915e83d14ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB196368B0>]}
[0m19:25:28.272641 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:25:28.578448 [debug] [MainThread]: checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, vars: {}, profile: , target: dev, version: 1.8.9
[0m19:25:28.631604 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:25:28.632080 [debug] [MainThread]: previous checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, current checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1
[0m19:25:28.632369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '34059f64-21ee-4c4a-9b26-915e83d14ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB19BDFE50>]}
[0m19:25:29.500552 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.marts
[0m19:25:29.505225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34059f64-21ee-4c4a-9b26-915e83d14ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB19C16F30>]}
[0m19:25:29.576024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34059f64-21ee-4c4a-9b26-915e83d14ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB19CD9C50>]}
[0m19:25:29.576618 [info ] [MainThread]: Found 2 models, 428 macros
[0m19:25:29.577065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34059f64-21ee-4c4a-9b26-915e83d14ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB1AED61A0>]}
[0m19:25:29.578698 [info ] [MainThread]: 
[0m19:25:29.579362 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:25:29.580604 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m19:25:29.668324 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m19:25:29.668714 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m19:25:29.669046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:25:29.788899 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.120 seconds
[0m19:25:29.790517 [debug] [ThreadPool]: On list_dbt: Close
[0m19:25:29.795092 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m19:25:29.800402 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m19:25:29.800787 [debug] [ThreadPool]: On list_dbt_test: BEGIN
[0m19:25:29.801045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:25:29.897508 [debug] [ThreadPool]: SQL status: BEGIN in 0.096 seconds
[0m19:25:29.897937 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m19:25:29.898224 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_test"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'test'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'test'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'test'
  
[0m19:25:29.902121 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m19:25:29.903562 [debug] [ThreadPool]: On list_dbt_test: ROLLBACK
[0m19:25:29.904212 [debug] [ThreadPool]: On list_dbt_test: Close
[0m19:25:29.908893 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:29.909267 [debug] [MainThread]: On master: BEGIN
[0m19:25:29.909513 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:25:30.017769 [debug] [MainThread]: SQL status: BEGIN in 0.108 seconds
[0m19:25:30.018159 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:30.018500 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:25:30.025837 [debug] [MainThread]: SQL status: SELECT 8 in 0.007 seconds
[0m19:25:30.027851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34059f64-21ee-4c4a-9b26-915e83d14ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB1B0EBB90>]}
[0m19:25:30.028289 [debug] [MainThread]: On master: ROLLBACK
[0m19:25:30.028861 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:30.029152 [debug] [MainThread]: On master: BEGIN
[0m19:25:30.029924 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:25:30.030305 [debug] [MainThread]: On master: COMMIT
[0m19:25:30.030635 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:30.030928 [debug] [MainThread]: On master: COMMIT
[0m19:25:30.031470 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:25:30.031795 [debug] [MainThread]: On master: Close
[0m19:25:30.032227 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:25:30.032542 [info ] [MainThread]: 
[0m19:25:30.035954 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_jaffle_shop__customers
[0m19:25:30.036524 [info ] [Thread-1 (]: 1 of 1 START sql view model test.stg_jaffle_shop__customers .................... [RUN]
[0m19:25:30.037056 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_jaffle_shop__customers'
[0m19:25:30.037373 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_jaffle_shop__customers
[0m19:25:30.043117 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:25:30.044053 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_jaffle_shop__customers
[0m19:25:30.078594 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:25:30.079599 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:25:30.080030 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: BEGIN
[0m19:25:30.080396 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:25:30.193065 [debug] [Thread-1 (]: SQL status: BEGIN in 0.112 seconds
[0m19:25:30.193541 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:25:30.193857 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__customers"} */

  create view "dbt"."test"."stg_jaffle_shop__customers__dbt_tmp"
    
    
  as (
    select
     trim(id)   as id
    ,trim(name) as name
from source.customers
  );
[0m19:25:30.196989 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:25:30.202827 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:25:30.203256 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__customers"} */
alter table "dbt"."test"."stg_jaffle_shop__customers" rename to "stg_jaffle_shop__customers__dbt_backup"
[0m19:25:30.204450 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:25:30.207650 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:25:30.208083 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__customers"} */
alter table "dbt"."test"."stg_jaffle_shop__customers__dbt_tmp" rename to "stg_jaffle_shop__customers"
[0m19:25:30.209028 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:25:30.224839 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: COMMIT
[0m19:25:30.225306 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:25:30.225613 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: COMMIT
[0m19:25:30.226902 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:25:30.232896 [debug] [Thread-1 (]: Applying DROP to: "dbt"."test"."stg_jaffle_shop__customers__dbt_backup"
[0m19:25:30.237404 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:25:30.237835 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__customers"} */
drop view if exists "dbt"."test"."stg_jaffle_shop__customers__dbt_backup" cascade
[0m19:25:30.241816 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m19:25:30.244168 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: Close
[0m19:25:30.245703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34059f64-21ee-4c4a-9b26-915e83d14ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB1B10A8E0>]}
[0m19:25:30.246434 [info ] [Thread-1 (]: 1 of 1 OK created sql view model test.stg_jaffle_shop__customers ............... [[32mCREATE VIEW[0m in 0.21s]
[0m19:25:30.247264 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_jaffle_shop__customers
[0m19:25:30.248978 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:30.249361 [debug] [MainThread]: On master: BEGIN
[0m19:25:30.249610 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:25:30.455600 [debug] [MainThread]: SQL status: BEGIN in 0.206 seconds
[0m19:25:30.456615 [debug] [MainThread]: On master: COMMIT
[0m19:25:30.456901 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:30.457154 [debug] [MainThread]: On master: COMMIT
[0m19:25:30.457695 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:25:30.457996 [debug] [MainThread]: On master: Close
[0m19:25:30.458398 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:25:30.458684 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m19:25:30.458903 [debug] [MainThread]: Connection 'list_dbt_test' was properly closed.
[0m19:25:30.459146 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_jaffle_shop__customers' was properly closed.
[0m19:25:30.459458 [info ] [MainThread]: 
[0m19:25:30.459786 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m19:25:30.460451 [debug] [MainThread]: Command end result
[0m19:25:30.485305 [info ] [MainThread]: 
[0m19:25:30.485846 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:25:30.486301 [info ] [MainThread]: 
[0m19:25:30.486852 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:25:30.488056 [debug] [MainThread]: Command `cli run` succeeded at 19:25:30.487859 after 2.62 seconds
[0m19:25:30.488460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB15B24D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB19D37530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB1AFEE0D0>]}
[0m19:25:30.488812 [debug] [MainThread]: Flushing usage events
[0m19:26:36.698720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002160EE2EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002160EABB890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216118547D0>]}


============================== 19:26:36.702730 | 587faf3d-10db-4d3a-9a2e-2dd6c4fb4025 ==============================
[0m19:26:36.702730 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:26:36.703255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\rodrigo.carpi\\Documents\\Personal\\Estudio\\dbt\\jaffle_shop\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\rodrigo.carpi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:26:36.944296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '587faf3d-10db-4d3a-9a2e-2dd6c4fb4025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021611F3A520>]}
[0m19:26:36.992144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '587faf3d-10db-4d3a-9a2e-2dd6c4fb4025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021611836690>]}
[0m19:26:36.993366 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:26:37.307600 [debug] [MainThread]: checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, vars: {}, profile: , target: dev, version: 1.8.9
[0m19:26:37.359578 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:26:37.360051 [debug] [MainThread]: previous checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, current checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1
[0m19:26:37.360345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '587faf3d-10db-4d3a-9a2e-2dd6c4fb4025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021613278350>]}
[0m19:26:38.306433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '587faf3d-10db-4d3a-9a2e-2dd6c4fb4025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021611E64D70>]}
[0m19:26:38.397489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '587faf3d-10db-4d3a-9a2e-2dd6c4fb4025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021611EBE970>]}
[0m19:26:38.398097 [info ] [MainThread]: Found 3 models, 428 macros
[0m19:26:38.398925 [warn ] [MainThread]: The selection criterion '+dim_customers' does not match any enabled nodes
[0m19:26:38.399820 [warn ] [MainThread]: The selection criterion '+dim_customers' does not match any enabled nodes
[0m19:26:38.400356 [warn ] [MainThread]: The selection criterion '+dim_customers' does not match any enabled nodes
[0m19:26:38.402122 [info ] [MainThread]: 
[0m19:26:38.402586 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:26:38.403143 [debug] [MainThread]: Command end result
[0m19:26:38.427653 [debug] [MainThread]: Command `cli build` succeeded at 19:26:38.427458 after 1.84 seconds
[0m19:26:38.428143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021613397E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216117DBAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216133A25D0>]}
[0m19:26:38.428509 [debug] [MainThread]: Flushing usage events
[0m19:26:55.106494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1C7CEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1C45B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1F2047D0>]}


============================== 19:26:55.110505 | 985b9bb3-75ff-461b-b42e-77d8c06bb9e2 ==============================
[0m19:26:55.110505 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:26:55.111029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\rodrigo.carpi\\.dbt', 'log_path': 'c:\\Users\\rodrigo.carpi\\Documents\\Personal\\Estudio\\dbt\\jaffle_shop\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:26:55.351291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '985b9bb3-75ff-461b-b42e-77d8c06bb9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1F93A520>]}
[0m19:26:55.397911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '985b9bb3-75ff-461b-b42e-77d8c06bb9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1F1E6690>]}
[0m19:26:55.399118 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:26:55.680747 [debug] [MainThread]: checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, vars: {}, profile: , target: dev, version: 1.8.9
[0m19:26:55.733916 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:26:55.734388 [debug] [MainThread]: previous checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, current checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1
[0m19:26:55.734678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '985b9bb3-75ff-461b-b42e-77d8c06bb9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE20C7C350>]}
[0m19:26:56.612367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '985b9bb3-75ff-461b-b42e-77d8c06bb9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1F864D70>]}
[0m19:26:56.700712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '985b9bb3-75ff-461b-b42e-77d8c06bb9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1F8BE970>]}
[0m19:26:56.701416 [info ] [MainThread]: Found 3 models, 428 macros
[0m19:26:56.703536 [info ] [MainThread]: 
[0m19:26:56.704183 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:26:56.708344 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m19:26:56.821822 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m19:26:56.822285 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m19:26:56.822558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:56.928653 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.106 seconds
[0m19:26:56.930112 [debug] [ThreadPool]: On list_dbt: Close
[0m19:26:56.932381 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m19:26:56.938703 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m19:26:56.939112 [debug] [ThreadPool]: On list_dbt_test: BEGIN
[0m19:26:56.939381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:57.034298 [debug] [ThreadPool]: SQL status: BEGIN in 0.095 seconds
[0m19:26:57.034735 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m19:26:57.035018 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_test"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'test'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'test'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'test'
  
[0m19:26:57.039237 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m19:26:57.040708 [debug] [ThreadPool]: On list_dbt_test: ROLLBACK
[0m19:26:57.041358 [debug] [ThreadPool]: On list_dbt_test: Close
[0m19:26:57.046486 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:57.046871 [debug] [MainThread]: On master: BEGIN
[0m19:26:57.047115 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:26:57.144663 [debug] [MainThread]: SQL status: BEGIN in 0.097 seconds
[0m19:26:57.145390 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:57.145900 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:26:57.153890 [debug] [MainThread]: SQL status: SELECT 9 in 0.007 seconds
[0m19:26:57.155940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '985b9bb3-75ff-461b-b42e-77d8c06bb9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE211E0050>]}
[0m19:26:57.156426 [debug] [MainThread]: On master: ROLLBACK
[0m19:26:57.156999 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:57.157333 [debug] [MainThread]: On master: BEGIN
[0m19:26:57.157971 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:26:57.158357 [debug] [MainThread]: On master: COMMIT
[0m19:26:57.158623 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:57.158867 [debug] [MainThread]: On master: COMMIT
[0m19:26:57.159361 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:26:57.159695 [debug] [MainThread]: On master: Close
[0m19:26:57.160201 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:26:57.160536 [info ] [MainThread]: 
[0m19:26:57.164362 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_jaffle_shop__customers
[0m19:26:57.165252 [info ] [Thread-1 (]: 1 of 3 START sql view model test.stg_jaffle_shop__customers .................... [RUN]
[0m19:26:57.165934 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_jaffle_shop__customers'
[0m19:26:57.166277 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_jaffle_shop__customers
[0m19:26:57.172085 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:26:57.173041 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_jaffle_shop__customers
[0m19:26:57.205542 [debug] [Thread-1 (]: Applying DROP to: "dbt"."test"."stg_jaffle_shop__customers__dbt_backup"
[0m19:26:57.210074 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:26:57.210515 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__customers"} */
drop view if exists "dbt"."test"."stg_jaffle_shop__customers__dbt_backup" cascade
[0m19:26:57.210823 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:26:57.322985 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.112 seconds
[0m19:26:57.331939 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:26:57.333019 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:26:57.333548 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: BEGIN
[0m19:26:57.334565 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m19:26:57.335087 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:26:57.335473 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__customers"} */

  create view "dbt"."test"."stg_jaffle_shop__customers__dbt_tmp"
    
    
  as (
    select
     trim(id)   as id
    ,trim(name) as name
from source.customers
  );
[0m19:26:57.338109 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:26:57.344505 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:26:57.344974 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__customers"} */
alter table "dbt"."test"."stg_jaffle_shop__customers" rename to "stg_jaffle_shop__customers__dbt_backup"
[0m19:26:57.345947 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:26:57.348862 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:26:57.349333 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__customers"} */
alter table "dbt"."test"."stg_jaffle_shop__customers__dbt_tmp" rename to "stg_jaffle_shop__customers"
[0m19:26:57.350329 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:26:57.366698 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: COMMIT
[0m19:26:57.367241 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:26:57.367766 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: COMMIT
[0m19:26:57.369243 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:26:57.371948 [debug] [Thread-1 (]: Applying DROP to: "dbt"."test"."stg_jaffle_shop__customers__dbt_backup"
[0m19:26:57.372704 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:26:57.373095 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__customers"} */
drop view if exists "dbt"."test"."stg_jaffle_shop__customers__dbt_backup" cascade
[0m19:26:57.374297 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m19:26:57.376729 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: Close
[0m19:26:57.378364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '985b9bb3-75ff-461b-b42e-77d8c06bb9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE215E0590>]}
[0m19:26:57.379131 [info ] [Thread-1 (]: 1 of 3 OK created sql view model test.stg_jaffle_shop__customers ............... [[32mCREATE VIEW[0m in 0.21s]
[0m19:26:57.380127 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_jaffle_shop__customers
[0m19:26:57.380736 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_jaffle_shop__orders
[0m19:26:57.381450 [info ] [Thread-1 (]: 2 of 3 START sql view model test.stg_jaffle_shop__orders ....................... [RUN]
[0m19:26:57.382007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_jaffle_shop__customers, now model.jaffle_shop.stg_jaffle_shop__orders)
[0m19:26:57.382425 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_jaffle_shop__orders
[0m19:26:57.384323 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_jaffle_shop__orders"
[0m19:26:57.385497 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_jaffle_shop__orders
[0m19:26:57.389255 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_jaffle_shop__orders"
[0m19:26:57.390332 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__orders"
[0m19:26:57.390792 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: BEGIN
[0m19:26:57.391160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:57.513768 [debug] [Thread-1 (]: SQL status: BEGIN in 0.122 seconds
[0m19:26:57.514502 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__orders"
[0m19:26:57.514831 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__orders"} */

  create view "dbt"."test"."stg_jaffle_shop__orders__dbt_tmp"
    
    
  as (
    select
     trim(id)                               as id
    ,trim(customer)                         as customer_id
    ,cast(trim(ordered_at) as timestamp)    as ordered_at
    ,trim(store_id)                         as store_id
    ,cast(trim(subtotal) as integer)        as subtotal
    ,cast(trim(tax_paid) as integer)        as tax_paid
    ,cast(trim(order_total) as integer)     as order_total
from source.orders
  );
[0m19:26:57.517951 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:26:57.520895 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__orders"
[0m19:26:57.521349 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__orders"} */
alter table "dbt"."test"."stg_jaffle_shop__orders" rename to "stg_jaffle_shop__orders__dbt_backup"
[0m19:26:57.522195 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:26:57.524846 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__orders"
[0m19:26:57.525313 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__orders"} */
alter table "dbt"."test"."stg_jaffle_shop__orders__dbt_tmp" rename to "stg_jaffle_shop__orders"
[0m19:26:57.526300 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:26:57.527980 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: COMMIT
[0m19:26:57.528349 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__orders"
[0m19:26:57.528649 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: COMMIT
[0m19:26:57.529966 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:26:57.532587 [debug] [Thread-1 (]: Applying DROP to: "dbt"."test"."stg_jaffle_shop__orders__dbt_backup"
[0m19:26:57.533255 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__orders"
[0m19:26:57.533584 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__orders"} */
drop view if exists "dbt"."test"."stg_jaffle_shop__orders__dbt_backup" cascade
[0m19:26:57.535479 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m19:26:57.536946 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: Close
[0m19:26:57.537542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '985b9bb3-75ff-461b-b42e-77d8c06bb9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE20EB9B20>]}
[0m19:26:57.538144 [info ] [Thread-1 (]: 2 of 3 OK created sql view model test.stg_jaffle_shop__orders .................. [[32mCREATE VIEW[0m in 0.16s]
[0m19:26:57.538759 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_jaffle_shop__orders
[0m19:26:57.539630 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m19:26:57.540257 [info ] [Thread-1 (]: 3 of 3 START sql table model test.dim_customers ................................ [RUN]
[0m19:26:57.540787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_jaffle_shop__orders, now model.jaffle_shop.dim_customers)
[0m19:26:57.541343 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m19:26:57.544461 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m19:26:57.545852 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m19:26:57.565516 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m19:26:57.567944 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m19:26:57.568650 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m19:26:57.569313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:26:57.666325 [debug] [Thread-1 (]: SQL status: BEGIN in 0.097 seconds
[0m19:26:57.666867 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m19:26:57.667229 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    

  create  table "dbt"."test"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select
         customer_id
        ,min(ordered_at)    as first_order_date
        ,max(ordered_at)    as last_order_date
        ,count(distinct id) as number_of_orders
        ,sum(subtotal)      as lifetime_spend_pretax
        ,sum(tax_paid)      as lifetime_tax_paid
        ,sum(order_total)   as lifetime_spend
    from "dbt"."test"."stg_jaffle_shop__orders"
    group by 1
)
select
     cst.id
    ,cst.name
    ,ord.first_order_date
    ,ord.last_order_date
    ,coalesce(ord.number_of_orders      , 0) as number_of_orders
    ,coalesce(ord.lifetime_spend_pretax , 0) as lifetime_spend_pretax
    ,coalesce(ord.lifetime_tax_paid     , 0) as lifetime_tax_paid
    ,coalesce(ord.lifetime_spend        , 0) as lifetime_spend
from "dbt"."test"."stg_jaffle_shop__customers" as cst
left join orders as ord
    on cst.id = ord.customer_id
  );
  
[0m19:26:58.435417 [debug] [Thread-1 (]: SQL status: SELECT 930 in 0.768 seconds
[0m19:26:58.440724 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m19:26:58.441461 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."test"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m19:26:58.442978 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:26:58.450376 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m19:26:58.450788 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m19:26:58.451082 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m19:26:58.452382 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:26:58.454608 [debug] [Thread-1 (]: Applying DROP to: "dbt"."test"."dim_customers__dbt_backup"
[0m19:26:58.457191 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m19:26:58.457582 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbt"."test"."dim_customers__dbt_backup" cascade
[0m19:26:58.459121 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m19:26:58.460979 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m19:26:58.461538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '985b9bb3-75ff-461b-b42e-77d8c06bb9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE2163F930>]}
[0m19:26:58.462149 [info ] [Thread-1 (]: 3 of 3 OK created sql table model test.dim_customers ........................... [[32mSELECT 930[0m in 0.92s]
[0m19:26:58.463189 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m19:26:58.464891 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:58.465274 [debug] [MainThread]: On master: BEGIN
[0m19:26:58.465522 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:26:58.581196 [debug] [MainThread]: SQL status: BEGIN in 0.116 seconds
[0m19:26:58.581629 [debug] [MainThread]: On master: COMMIT
[0m19:26:58.581886 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:58.582131 [debug] [MainThread]: On master: COMMIT
[0m19:26:58.582658 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:26:58.582982 [debug] [MainThread]: On master: Close
[0m19:26:58.583432 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:26:58.583757 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m19:26:58.584013 [debug] [MainThread]: Connection 'list_dbt_test' was properly closed.
[0m19:26:58.584232 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m19:26:58.584644 [info ] [MainThread]: 
[0m19:26:58.585001 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 1.88 seconds (1.88s).
[0m19:26:58.586122 [debug] [MainThread]: Command end result
[0m19:26:58.610808 [info ] [MainThread]: 
[0m19:26:58.611608 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:26:58.612023 [info ] [MainThread]: 
[0m19:26:58.612434 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:26:58.613510 [debug] [MainThread]: Command `cli build` succeeded at 19:26:58.613323 after 3.62 seconds
[0m19:26:58.613919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1F393CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1F9F6AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1F3B11D0>]}
[0m19:26:58.614250 [debug] [MainThread]: Flushing usage events
[0m19:47:05.033685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F83D0BEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F83CD4B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F83FAF47D0>]}


============================== 19:47:05.038232 | dc604c3b-fc98-419f-8e18-3b3505102205 ==============================
[0m19:47:05.038232 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:47:05.038852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\rodrigo.carpi\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\rodrigo.carpi\\Documents\\Personal\\Estudio\\dbt\\jaffle_shop\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m19:47:05.295255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc604c3b-fc98-419f-8e18-3b3505102205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F84017A520>]}
[0m19:47:05.345293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc604c3b-fc98-419f-8e18-3b3505102205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F83FAD68B0>]}
[0m19:47:05.346533 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:47:05.659088 [debug] [MainThread]: checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, vars: {}, profile: , target: dev, version: 1.8.9
[0m19:47:05.730288 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:47:05.730772 [debug] [MainThread]: previous checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, current checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1
[0m19:47:05.731059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dc604c3b-fc98-419f-8e18-3b3505102205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F84006DE50>]}
[0m19:47:06.651845 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop.stg_jaffle_shop__customers' (models\staging\stg_jaffle_shop__customers.sql) depends on a source named 'source.customers' which was not found
[0m19:47:06.652998 [debug] [MainThread]: Command `cli run` failed at 19:47:06.652829 after 1.75 seconds
[0m19:47:06.653442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8413D1E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8413D33E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F84016B150>]}
[0m19:47:06.653807 [debug] [MainThread]: Flushing usage events
[0m19:48:03.948408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E1041EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E100AB890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E12E547D0>]}


============================== 19:48:03.952778 | 0cf9164e-1110-4e2b-88a2-11c7f22c46f3 ==============================
[0m19:48:03.952778 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:48:03.953328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\rodrigo.carpi\\Documents\\Personal\\Estudio\\dbt\\jaffle_shop\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\rodrigo.carpi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:48:04.216409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cf9164e-1110-4e2b-88a2-11c7f22c46f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E1353A520>]}
[0m19:48:04.264474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cf9164e-1110-4e2b-88a2-11c7f22c46f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E12E368B0>]}
[0m19:48:04.265726 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:48:04.556660 [debug] [MainThread]: checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, vars: {}, profile: , target: dev, version: 1.8.9
[0m19:48:04.628844 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:48:04.629377 [debug] [MainThread]: previous checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, current checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1
[0m19:48:04.629831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0cf9164e-1110-4e2b-88a2-11c7f22c46f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E1342DE50>]}
[0m19:48:05.630726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cf9164e-1110-4e2b-88a2-11c7f22c46f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E13464F50>]}
[0m19:48:05.719091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cf9164e-1110-4e2b-88a2-11c7f22c46f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E135B9550>]}
[0m19:48:05.719602 [info ] [MainThread]: Found 3 models, 2 sources, 428 macros
[0m19:48:05.719952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cf9164e-1110-4e2b-88a2-11c7f22c46f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E13789F30>]}
[0m19:48:05.721519 [info ] [MainThread]: 
[0m19:48:05.722153 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:48:05.723191 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m19:48:05.824031 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m19:48:05.824438 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m19:48:05.824707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:05.947503 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.123 seconds
[0m19:48:05.948970 [debug] [ThreadPool]: On list_dbt: Close
[0m19:48:05.954143 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m19:48:05.959304 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m19:48:05.959693 [debug] [ThreadPool]: On list_dbt_test: BEGIN
[0m19:48:05.959976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:06.055494 [debug] [ThreadPool]: SQL status: BEGIN in 0.095 seconds
[0m19:48:06.055888 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m19:48:06.056182 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_test"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'test'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'test'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'test'
  
[0m19:48:06.060329 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m19:48:06.061741 [debug] [ThreadPool]: On list_dbt_test: ROLLBACK
[0m19:48:06.062256 [debug] [ThreadPool]: On list_dbt_test: Close
[0m19:48:06.069264 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:06.069688 [debug] [MainThread]: On master: BEGIN
[0m19:48:06.069957 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:48:06.176167 [debug] [MainThread]: SQL status: BEGIN in 0.106 seconds
[0m19:48:06.176712 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:06.177056 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:48:06.185337 [debug] [MainThread]: SQL status: SELECT 10 in 0.008 seconds
[0m19:48:06.188147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cf9164e-1110-4e2b-88a2-11c7f22c46f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E14D2C650>]}
[0m19:48:06.188571 [debug] [MainThread]: On master: ROLLBACK
[0m19:48:06.189288 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:06.189595 [debug] [MainThread]: On master: BEGIN
[0m19:48:06.190188 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:48:06.190509 [debug] [MainThread]: On master: COMMIT
[0m19:48:06.190769 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:06.191017 [debug] [MainThread]: On master: COMMIT
[0m19:48:06.191433 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:48:06.191728 [debug] [MainThread]: On master: Close
[0m19:48:06.192149 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:48:06.192474 [info ] [MainThread]: 
[0m19:48:06.196248 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_jaffle_shop__customers
[0m19:48:06.197203 [info ] [Thread-1 (]: 1 of 1 START sql view model test.stg_jaffle_shop__customers .................... [RUN]
[0m19:48:06.197910 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_jaffle_shop__customers'
[0m19:48:06.198330 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_jaffle_shop__customers
[0m19:48:06.205129 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:48:06.206159 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_jaffle_shop__customers
[0m19:48:06.240302 [debug] [Thread-1 (]: Applying DROP to: "dbt"."test"."stg_jaffle_shop__customers__dbt_backup"
[0m19:48:06.244953 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:48:06.245445 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__customers"} */
drop view if exists "dbt"."test"."stg_jaffle_shop__customers__dbt_backup" cascade
[0m19:48:06.245797 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:48:06.364157 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.118 seconds
[0m19:48:06.372645 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:48:06.373643 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:48:06.374014 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: BEGIN
[0m19:48:06.374934 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m19:48:06.375694 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:48:06.376070 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__customers"} */

  create view "dbt"."test"."stg_jaffle_shop__customers__dbt_tmp"
    
    
  as (
    select
     trim(id)   as id
    ,trim(name) as name
from "dbt"."source"."customers"
  );
[0m19:48:06.379157 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:48:06.385829 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:48:06.386296 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__customers"} */
alter table "dbt"."test"."stg_jaffle_shop__customers" rename to "stg_jaffle_shop__customers__dbt_backup"
[0m19:48:06.387395 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:48:06.390001 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:48:06.390412 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__customers"} */
alter table "dbt"."test"."stg_jaffle_shop__customers__dbt_tmp" rename to "stg_jaffle_shop__customers"
[0m19:48:06.391291 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:48:06.406295 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: COMMIT
[0m19:48:06.406747 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:48:06.407056 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: COMMIT
[0m19:48:06.409538 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:48:06.411906 [debug] [Thread-1 (]: Applying DROP to: "dbt"."test"."stg_jaffle_shop__customers__dbt_backup"
[0m19:48:06.412556 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m19:48:06.412894 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__customers"} */
drop view if exists "dbt"."test"."stg_jaffle_shop__customers__dbt_backup" cascade
[0m19:48:06.414252 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m19:48:06.416845 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: Close
[0m19:48:06.418462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cf9164e-1110-4e2b-88a2-11c7f22c46f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E14C792E0>]}
[0m19:48:06.419224 [info ] [Thread-1 (]: 1 of 1 OK created sql view model test.stg_jaffle_shop__customers ............... [[32mCREATE VIEW[0m in 0.22s]
[0m19:48:06.419897 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_jaffle_shop__customers
[0m19:48:06.421495 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:06.421878 [debug] [MainThread]: On master: BEGIN
[0m19:48:06.422380 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:48:06.520042 [debug] [MainThread]: SQL status: BEGIN in 0.098 seconds
[0m19:48:06.521007 [debug] [MainThread]: On master: COMMIT
[0m19:48:06.521380 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:06.521635 [debug] [MainThread]: On master: COMMIT
[0m19:48:06.522145 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:48:06.522475 [debug] [MainThread]: On master: Close
[0m19:48:06.522895 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:48:06.523151 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m19:48:06.523383 [debug] [MainThread]: Connection 'list_dbt_test' was properly closed.
[0m19:48:06.523621 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_jaffle_shop__customers' was properly closed.
[0m19:48:06.523967 [info ] [MainThread]: 
[0m19:48:06.524306 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m19:48:06.524975 [debug] [MainThread]: Command end result
[0m19:48:06.549619 [info ] [MainThread]: 
[0m19:48:06.550167 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:48:06.550522 [info ] [MainThread]: 
[0m19:48:06.550907 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:48:06.551899 [debug] [MainThread]: Command `cli run` succeeded at 19:48:06.551719 after 2.74 seconds
[0m19:48:06.552288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E150E6CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E149BF6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E10960DD0>]}
[0m19:48:06.552616 [debug] [MainThread]: Flushing usage events
[0m19:48:49.781779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175BA21EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B9EAB890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175BCC447D0>]}


============================== 19:48:49.785689 | 24018a9e-cea8-4049-8237-10362bd178e2 ==============================
[0m19:48:49.785689 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:48:49.786214 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\rodrigo.carpi\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\rodrigo.carpi\\Documents\\Personal\\Estudio\\dbt\\jaffle_shop\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:48:50.023004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24018a9e-cea8-4049-8237-10362bd178e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175BD31A520>]}
[0m19:48:50.071225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24018a9e-cea8-4049-8237-10362bd178e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175BCC268B0>]}
[0m19:48:50.072292 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:48:50.362891 [debug] [MainThread]: checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, vars: {}, profile: , target: dev, version: 1.8.9
[0m19:48:50.433122 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:48:50.433584 [debug] [MainThread]: previous checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, current checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1
[0m19:48:50.433913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '24018a9e-cea8-4049-8237-10362bd178e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175BD20DE50>]}
[0m19:48:51.400525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24018a9e-cea8-4049-8237-10362bd178e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175BD244F50>]}
[0m19:48:51.484877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24018a9e-cea8-4049-8237-10362bd178e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175BD395550>]}
[0m19:48:51.485384 [info ] [MainThread]: Found 3 models, 2 sources, 428 macros
[0m19:48:51.485766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24018a9e-cea8-4049-8237-10362bd178e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175BE535F30>]}
[0m19:48:51.487222 [info ] [MainThread]: 
[0m19:48:51.487823 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:48:51.488827 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m19:48:51.576922 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m19:48:51.577359 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m19:48:51.577679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:51.679549 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.102 seconds
[0m19:48:51.680858 [debug] [ThreadPool]: On list_dbt: Close
[0m19:48:51.685250 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m19:48:51.690496 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m19:48:51.690906 [debug] [ThreadPool]: On list_dbt_test: BEGIN
[0m19:48:51.691169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:51.806814 [debug] [ThreadPool]: SQL status: BEGIN in 0.115 seconds
[0m19:48:51.807764 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m19:48:51.808077 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_test"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'test'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'test'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'test'
  
[0m19:48:51.812648 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m19:48:51.814090 [debug] [ThreadPool]: On list_dbt_test: ROLLBACK
[0m19:48:51.814798 [debug] [ThreadPool]: On list_dbt_test: Close
[0m19:48:51.820175 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:51.820575 [debug] [MainThread]: On master: BEGIN
[0m19:48:51.820830 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:48:51.931562 [debug] [MainThread]: SQL status: BEGIN in 0.111 seconds
[0m19:48:51.931959 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:51.932305 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:48:51.941097 [debug] [MainThread]: SQL status: SELECT 10 in 0.008 seconds
[0m19:48:51.943027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24018a9e-cea8-4049-8237-10362bd178e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175BEB0C650>]}
[0m19:48:51.943480 [debug] [MainThread]: On master: ROLLBACK
[0m19:48:51.944188 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:51.944717 [debug] [MainThread]: On master: BEGIN
[0m19:48:51.945498 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:48:51.945882 [debug] [MainThread]: On master: COMMIT
[0m19:48:51.946147 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:51.946406 [debug] [MainThread]: On master: COMMIT
[0m19:48:51.946848 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:48:51.947150 [debug] [MainThread]: On master: Close
[0m19:48:51.947585 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:48:51.947914 [info ] [MainThread]: 
[0m19:48:51.951333 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_jaffle_shop__orders
[0m19:48:51.951908 [info ] [Thread-1 (]: 1 of 1 START sql view model test.stg_jaffle_shop__orders ....................... [RUN]
[0m19:48:51.952462 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_jaffle_shop__orders'
[0m19:48:51.952879 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_jaffle_shop__orders
[0m19:48:51.959601 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_jaffle_shop__orders"
[0m19:48:51.960838 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_jaffle_shop__orders
[0m19:48:51.994104 [debug] [Thread-1 (]: Applying DROP to: "dbt"."test"."stg_jaffle_shop__orders__dbt_backup"
[0m19:48:51.998946 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__orders"
[0m19:48:51.999393 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__orders"} */
drop view if exists "dbt"."test"."stg_jaffle_shop__orders__dbt_backup" cascade
[0m19:48:51.999717 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:48:52.097755 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.098 seconds
[0m19:48:52.105845 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_jaffle_shop__orders"
[0m19:48:52.107455 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__orders"
[0m19:48:52.107848 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: BEGIN
[0m19:48:52.108677 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m19:48:52.109116 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__orders"
[0m19:48:52.109460 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__orders"} */

  create view "dbt"."test"."stg_jaffle_shop__orders__dbt_tmp"
    
    
  as (
    select
     trim(id)                               as id
    ,trim(customer)                         as customer_id
    ,cast(trim(ordered_at) as timestamp)    as ordered_at
    ,trim(store_id)                         as store_id
    ,cast(trim(subtotal) as integer)        as subtotal
    ,cast(trim(tax_paid) as integer)        as tax_paid
    ,cast(trim(order_total) as integer)     as order_total
from "dbt"."source"."orders"
  );
[0m19:48:52.111964 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:48:52.118077 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__orders"
[0m19:48:52.118518 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__orders"} */
alter table "dbt"."test"."stg_jaffle_shop__orders" rename to "stg_jaffle_shop__orders__dbt_backup"
[0m19:48:52.119813 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:48:52.123196 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__orders"
[0m19:48:52.123586 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__orders"} */
alter table "dbt"."test"."stg_jaffle_shop__orders__dbt_tmp" rename to "stg_jaffle_shop__orders"
[0m19:48:52.124604 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:48:52.140750 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: COMMIT
[0m19:48:52.141242 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__orders"
[0m19:48:52.141562 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: COMMIT
[0m19:48:52.147797 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m19:48:52.150401 [debug] [Thread-1 (]: Applying DROP to: "dbt"."test"."stg_jaffle_shop__orders__dbt_backup"
[0m19:48:52.151100 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__orders"
[0m19:48:52.151433 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__orders"} */
drop view if exists "dbt"."test"."stg_jaffle_shop__orders__dbt_backup" cascade
[0m19:48:52.153038 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m19:48:52.155561 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: Close
[0m19:48:52.157217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24018a9e-cea8-4049-8237-10362bd178e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175BEA592E0>]}
[0m19:48:52.158037 [info ] [Thread-1 (]: 1 of 1 OK created sql view model test.stg_jaffle_shop__orders .................. [[32mCREATE VIEW[0m in 0.20s]
[0m19:48:52.158849 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_jaffle_shop__orders
[0m19:48:52.160776 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:52.161223 [debug] [MainThread]: On master: BEGIN
[0m19:48:52.161485 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:48:52.269718 [debug] [MainThread]: SQL status: BEGIN in 0.108 seconds
[0m19:48:52.270244 [debug] [MainThread]: On master: COMMIT
[0m19:48:52.270829 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:52.271087 [debug] [MainThread]: On master: COMMIT
[0m19:48:52.271531 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:48:52.271855 [debug] [MainThread]: On master: Close
[0m19:48:52.272269 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:48:52.272526 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m19:48:52.272760 [debug] [MainThread]: Connection 'list_dbt_test' was properly closed.
[0m19:48:52.273016 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_jaffle_shop__orders' was properly closed.
[0m19:48:52.273339 [info ] [MainThread]: 
[0m19:48:52.273670 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m19:48:52.274384 [debug] [MainThread]: Command end result
[0m19:48:52.301406 [info ] [MainThread]: 
[0m19:48:52.301915 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:48:52.302262 [info ] [MainThread]: 
[0m19:48:52.302699 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:48:52.303767 [debug] [MainThread]: Command `cli run` succeeded at 19:48:52.303581 after 2.64 seconds
[0m19:48:52.304180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175BEEC2AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175BE7CF6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175BA760DD0>]}
[0m19:48:52.304513 [debug] [MainThread]: Flushing usage events
[0m23:40:02.917514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002995802EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029957CBB890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002995AA547D0>]}


============================== 23:40:02.926070 | 1b0428c9-bdbe-4d7f-9d78-56df6f851607 ==============================
[0m23:40:02.926070 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:40:02.926712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\rodrigo.carpi\\Documents\\Personal\\Estudio\\dbt\\jaffle_shop\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\rodrigo.carpi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:40:03.316277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b0428c9-bdbe-4d7f-9d78-56df6f851607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002995B10E520>]}
[0m23:40:03.390003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b0428c9-bdbe-4d7f-9d78-56df6f851607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002995AA368B0>]}
[0m23:40:03.392498 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:40:03.719019 [debug] [MainThread]: checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, vars: {}, profile: , target: dev, version: 1.8.9
[0m23:40:03.789975 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m23:40:03.790497 [debug] [MainThread]: previous checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, current checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1
[0m23:40:03.790960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1b0428c9-bdbe-4d7f-9d78-56df6f851607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002995AFFDE50>]}
[0m23:40:04.773325 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:40:04.773955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1b0428c9-bdbe-4d7f-9d78-56df6f851607', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002995B0347D0>]}
[0m23:40:05.051081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b0428c9-bdbe-4d7f-9d78-56df6f851607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002995B09EB30>]}
[0m23:40:05.190979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b0428c9-bdbe-4d7f-9d78-56df6f851607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002995C7B7380>]}
[0m23:40:05.191990 [info ] [MainThread]: Found 3 models, 3 data tests, 2 sources, 428 macros
[0m23:40:05.192712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b0428c9-bdbe-4d7f-9d78-56df6f851607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002995C6AB710>]}
[0m23:40:05.195447 [info ] [MainThread]: 
[0m23:40:05.196058 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:40:05.199848 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m23:40:05.323082 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m23:40:05.323562 [debug] [ThreadPool]: On list_dbt_test: BEGIN
[0m23:40:05.323900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:05.455986 [debug] [ThreadPool]: SQL status: BEGIN in 0.132 seconds
[0m23:40:05.456647 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m23:40:05.456949 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_test"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'test'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'test'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'test'
  
[0m23:40:05.471863 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m23:40:05.474464 [debug] [ThreadPool]: On list_dbt_test: ROLLBACK
[0m23:40:05.475442 [debug] [ThreadPool]: On list_dbt_test: Close
[0m23:40:05.481564 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:05.481946 [debug] [MainThread]: On master: BEGIN
[0m23:40:05.482195 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:40:05.598360 [debug] [MainThread]: SQL status: BEGIN in 0.116 seconds
[0m23:40:05.598913 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:05.599244 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:40:05.611525 [debug] [MainThread]: SQL status: SELECT 10 in 0.012 seconds
[0m23:40:05.613571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b0428c9-bdbe-4d7f-9d78-56df6f851607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002995C732FC0>]}
[0m23:40:05.613985 [debug] [MainThread]: On master: ROLLBACK
[0m23:40:05.614714 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:05.615336 [debug] [MainThread]: On master: BEGIN
[0m23:40:05.616253 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:40:05.616576 [debug] [MainThread]: On master: COMMIT
[0m23:40:05.616837 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:05.617078 [debug] [MainThread]: On master: COMMIT
[0m23:40:05.617544 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:40:05.618068 [debug] [MainThread]: On master: Close
[0m23:40:05.618908 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:40:05.619286 [info ] [MainThread]: 
[0m23:40:05.625257 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9
[0m23:40:05.625825 [info ] [Thread-1 (]: 1 of 3 START test not_null_stg_jaffle_shop__customers_id ....................... [RUN]
[0m23:40:05.626340 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9'
[0m23:40:05.626652 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9
[0m23:40:05.642819 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9"
[0m23:40:05.644539 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9
[0m23:40:05.658320 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9"
[0m23:40:05.660458 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9"
[0m23:40:05.660941 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9: BEGIN
[0m23:40:05.661288 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:40:05.787469 [debug] [Thread-1 (]: SQL status: BEGIN in 0.126 seconds
[0m23:40:05.787953 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9"
[0m23:40:05.788300 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."test"."stg_jaffle_shop__customers"
where id is null



      
    ) dbt_internal_test
[0m23:40:05.793372 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m23:40:05.797669 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9: ROLLBACK
[0m23:40:05.798460 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9: Close
[0m23:40:05.799185 [info ] [Thread-1 (]: 1 of 3 PASS not_null_stg_jaffle_shop__customers_id ............................. [[32mPASS[0m in 0.17s]
[0m23:40:05.799944 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9
[0m23:40:05.800429 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d
[0m23:40:05.800850 [info ] [Thread-1 (]: 2 of 3 START test not_null_stg_jaffle_shop__customers_name ..................... [RUN]
[0m23:40:05.801377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9, now test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d)
[0m23:40:05.801770 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d
[0m23:40:05.806145 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d"
[0m23:40:05.808116 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d
[0m23:40:05.810857 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d"
[0m23:40:05.812856 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d"
[0m23:40:05.813320 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d: BEGIN
[0m23:40:05.813671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:05.960371 [debug] [Thread-1 (]: SQL status: BEGIN in 0.147 seconds
[0m23:40:05.960917 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d"
[0m23:40:05.961285 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "dbt"."test"."stg_jaffle_shop__customers"
where name is null



      
    ) dbt_internal_test
[0m23:40:05.963812 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:40:05.966033 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d: ROLLBACK
[0m23:40:05.966827 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d: Close
[0m23:40:05.967766 [info ] [Thread-1 (]: 2 of 3 PASS not_null_stg_jaffle_shop__customers_name ........................... [[32mPASS[0m in 0.17s]
[0m23:40:05.968777 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d
[0m23:40:05.969510 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788
[0m23:40:05.970166 [info ] [Thread-1 (]: 3 of 3 START test unique_stg_jaffle_shop__customers_id ......................... [RUN]
[0m23:40:05.970801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d, now test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788)
[0m23:40:05.971355 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788
[0m23:40:05.979441 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788"
[0m23:40:05.980669 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788
[0m23:40:05.983987 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788"
[0m23:40:05.985292 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788"
[0m23:40:05.986152 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788: BEGIN
[0m23:40:05.986689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:06.109873 [debug] [Thread-1 (]: SQL status: BEGIN in 0.123 seconds
[0m23:40:06.110422 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788"
[0m23:40:06.110801 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."test"."stg_jaffle_shop__customers"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:40:06.114301 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:40:06.115888 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788: ROLLBACK
[0m23:40:06.116517 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788: Close
[0m23:40:06.117125 [info ] [Thread-1 (]: 3 of 3 PASS unique_stg_jaffle_shop__customers_id ............................... [[32mPASS[0m in 0.15s]
[0m23:40:06.117872 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788
[0m23:40:06.119595 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:06.120009 [debug] [MainThread]: On master: BEGIN
[0m23:40:06.120301 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:40:06.224868 [debug] [MainThread]: SQL status: BEGIN in 0.104 seconds
[0m23:40:06.225369 [debug] [MainThread]: On master: COMMIT
[0m23:40:06.225628 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:06.225907 [debug] [MainThread]: On master: COMMIT
[0m23:40:06.226484 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:40:06.226834 [debug] [MainThread]: On master: Close
[0m23:40:06.227311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:40:06.227577 [debug] [MainThread]: Connection 'list_dbt_test' was properly closed.
[0m23:40:06.227818 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788' was properly closed.
[0m23:40:06.228538 [info ] [MainThread]: 
[0m23:40:06.228912 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m23:40:06.229887 [debug] [MainThread]: Command end result
[0m23:40:06.261785 [info ] [MainThread]: 
[0m23:40:06.262496 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:40:06.263105 [info ] [MainThread]: 
[0m23:40:06.263620 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:40:06.264766 [debug] [MainThread]: Command `cli test` succeeded at 23:40:06.264559 after 3.51 seconds
[0m23:40:06.265196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002995CAF22B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002995C7E7E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002995C5EB850>]}
[0m23:40:06.265527 [debug] [MainThread]: Flushing usage events
[0m23:44:25.367284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017103C7EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001710390B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171066A47D0>]}


============================== 23:44:25.371564 | d49ac6cf-8f80-4d6c-b0fa-685f6602891f ==============================
[0m23:44:25.371564 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:44:25.372100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\rodrigo.carpi\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\rodrigo.carpi\\Documents\\Personal\\Estudio\\dbt\\jaffle_shop\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m23:44:25.650441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd49ac6cf-8f80-4d6c-b0fa-685f6602891f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017106D8A520>]}
[0m23:44:25.702235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd49ac6cf-8f80-4d6c-b0fa-685f6602891f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171066868B0>]}
[0m23:44:25.703384 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:44:25.999755 [debug] [MainThread]: checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, vars: {}, profile: , target: dev, version: 1.8.9
[0m23:44:26.152985 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:44:26.153550 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models\staging\stg_jaffle_shop__orders.yml
[0m23:44:26.207325 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:44:26.208088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd49ac6cf-8f80-4d6c-b0fa-685f6602891f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017106C7D150>]}
[0m23:44:26.405302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd49ac6cf-8f80-4d6c-b0fa-685f6602891f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017106CB74D0>]}
[0m23:44:26.519443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd49ac6cf-8f80-4d6c-b0fa-685f6602891f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017108404130>]}
[0m23:44:26.519960 [info ] [MainThread]: Found 3 models, 8 data tests, 2 sources, 428 macros
[0m23:44:26.520307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd49ac6cf-8f80-4d6c-b0fa-685f6602891f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171083A3EE0>]}
[0m23:44:26.522114 [info ] [MainThread]: 
[0m23:44:26.522913 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:44:26.527478 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m23:44:26.615531 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m23:44:26.615941 [debug] [ThreadPool]: On list_dbt_test: BEGIN
[0m23:44:26.616202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:44:26.761848 [debug] [ThreadPool]: SQL status: BEGIN in 0.146 seconds
[0m23:44:26.762310 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m23:44:26.762644 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_test"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'test'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'test'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'test'
  
[0m23:44:26.768651 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m23:44:26.770313 [debug] [ThreadPool]: On list_dbt_test: ROLLBACK
[0m23:44:26.771082 [debug] [ThreadPool]: On list_dbt_test: Close
[0m23:44:26.778068 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:26.778469 [debug] [MainThread]: On master: BEGIN
[0m23:44:26.778737 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:44:26.901259 [debug] [MainThread]: SQL status: BEGIN in 0.122 seconds
[0m23:44:26.901729 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:26.902104 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:44:26.911733 [debug] [MainThread]: SQL status: SELECT 10 in 0.009 seconds
[0m23:44:26.913372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd49ac6cf-8f80-4d6c-b0fa-685f6602891f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001710826F890>]}
[0m23:44:26.913867 [debug] [MainThread]: On master: ROLLBACK
[0m23:44:26.914498 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:26.914814 [debug] [MainThread]: On master: BEGIN
[0m23:44:26.915653 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:44:26.916372 [debug] [MainThread]: On master: COMMIT
[0m23:44:26.916964 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:26.917244 [debug] [MainThread]: On master: COMMIT
[0m23:44:26.917770 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:44:26.918154 [debug] [MainThread]: On master: Close
[0m23:44:26.918623 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:44:26.918992 [info ] [MainThread]: 
[0m23:44:26.922785 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832
[0m23:44:26.923684 [info ] [Thread-1 (]: 1 of 5 START test not_null_stg_jaffle_shop__orders_customer_id ................. [RUN]
[0m23:44:26.925024 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832'
[0m23:44:26.925667 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832
[0m23:44:26.943879 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832"
[0m23:44:26.945532 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832
[0m23:44:26.963347 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832"
[0m23:44:26.964895 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832"
[0m23:44:26.965425 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832: BEGIN
[0m23:44:26.965827 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:44:27.179952 [debug] [Thread-1 (]: SQL status: BEGIN in 0.214 seconds
[0m23:44:27.180408 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832"
[0m23:44:27.180736 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dbt"."test"."stg_jaffle_shop__orders"
where customer_id is null



      
    ) dbt_internal_test
[0m23:44:27.238402 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.057 seconds
[0m23:44:27.242807 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832: ROLLBACK
[0m23:44:27.243487 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832: Close
[0m23:44:27.244153 [info ] [Thread-1 (]: 1 of 5 PASS not_null_stg_jaffle_shop__orders_customer_id ....................... [[32mPASS[0m in 0.32s]
[0m23:44:27.244867 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832
[0m23:44:27.245343 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea
[0m23:44:27.245864 [info ] [Thread-1 (]: 2 of 5 START test not_null_stg_jaffle_shop__orders_id .......................... [RUN]
[0m23:44:27.246364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832, now test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea)
[0m23:44:27.246703 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea
[0m23:44:27.250747 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea"
[0m23:44:27.252063 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea
[0m23:44:27.254100 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea"
[0m23:44:27.255425 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea"
[0m23:44:27.256002 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea: BEGIN
[0m23:44:27.256607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:27.391572 [debug] [Thread-1 (]: SQL status: BEGIN in 0.135 seconds
[0m23:44:27.392146 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea"
[0m23:44:27.392593 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."test"."stg_jaffle_shop__orders"
where id is null



      
    ) dbt_internal_test
[0m23:44:27.412606 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.019 seconds
[0m23:44:27.414428 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea: ROLLBACK
[0m23:44:27.415268 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea: Close
[0m23:44:27.416221 [info ] [Thread-1 (]: 2 of 5 PASS not_null_stg_jaffle_shop__orders_id ................................ [[32mPASS[0m in 0.17s]
[0m23:44:27.416846 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea
[0m23:44:27.417235 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75
[0m23:44:27.417605 [info ] [Thread-1 (]: 3 of 5 START test not_null_stg_jaffle_shop__orders_ordered_at .................. [RUN]
[0m23:44:27.418052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea, now test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75)
[0m23:44:27.418559 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75
[0m23:44:27.421954 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75"
[0m23:44:27.423099 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75
[0m23:44:27.426988 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75"
[0m23:44:27.428042 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75"
[0m23:44:27.428433 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75: BEGIN
[0m23:44:27.428757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:27.547553 [debug] [Thread-1 (]: SQL status: BEGIN in 0.119 seconds
[0m23:44:27.548389 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75"
[0m23:44:27.549095 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ordered_at
from "dbt"."test"."stg_jaffle_shop__orders"
where ordered_at is null



      
    ) dbt_internal_test
[0m23:44:27.733957 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.184 seconds
[0m23:44:27.735671 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75: ROLLBACK
[0m23:44:27.736416 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75: Close
[0m23:44:27.737124 [info ] [Thread-1 (]: 3 of 5 PASS not_null_stg_jaffle_shop__orders_ordered_at ........................ [[32mPASS[0m in 0.32s]
[0m23:44:27.737896 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75
[0m23:44:27.738427 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9
[0m23:44:27.739231 [info ] [Thread-1 (]: 4 of 5 START test not_null_stg_jaffle_shop__orders_store_id .................... [RUN]
[0m23:44:27.740300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75, now test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9)
[0m23:44:27.740975 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9
[0m23:44:27.744766 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9"
[0m23:44:27.745895 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9
[0m23:44:27.747860 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9"
[0m23:44:27.748911 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9"
[0m23:44:27.749309 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9: BEGIN
[0m23:44:27.749615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:27.867465 [debug] [Thread-1 (]: SQL status: BEGIN in 0.118 seconds
[0m23:44:27.867905 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9"
[0m23:44:27.868226 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "dbt"."test"."stg_jaffle_shop__orders"
where store_id is null



      
    ) dbt_internal_test
[0m23:44:27.890826 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.022 seconds
[0m23:44:27.893333 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9: ROLLBACK
[0m23:44:27.894297 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9: Close
[0m23:44:27.895137 [info ] [Thread-1 (]: 4 of 5 PASS not_null_stg_jaffle_shop__orders_store_id .......................... [[32mPASS[0m in 0.15s]
[0m23:44:27.895868 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9
[0m23:44:27.896315 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635
[0m23:44:27.896996 [info ] [Thread-1 (]: 5 of 5 START test unique_stg_jaffle_shop__orders_id ............................ [RUN]
[0m23:44:27.897541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9, now test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635)
[0m23:44:27.897890 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635
[0m23:44:27.907874 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635"
[0m23:44:27.909114 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635
[0m23:44:27.911255 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635"
[0m23:44:27.912377 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635"
[0m23:44:27.912842 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635: BEGIN
[0m23:44:27.913164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:28.038360 [debug] [Thread-1 (]: SQL status: BEGIN in 0.125 seconds
[0m23:44:28.038805 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635"
[0m23:44:28.039136 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."test"."stg_jaffle_shop__orders"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:44:28.110697 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.071 seconds
[0m23:44:28.112354 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635: ROLLBACK
[0m23:44:28.113343 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635: Close
[0m23:44:28.114054 [info ] [Thread-1 (]: 5 of 5 PASS unique_stg_jaffle_shop__orders_id .................................. [[32mPASS[0m in 0.22s]
[0m23:44:28.114736 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635
[0m23:44:28.116660 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:28.117071 [debug] [MainThread]: On master: BEGIN
[0m23:44:28.117324 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:44:28.227067 [debug] [MainThread]: SQL status: BEGIN in 0.110 seconds
[0m23:44:28.227535 [debug] [MainThread]: On master: COMMIT
[0m23:44:28.227834 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:28.228079 [debug] [MainThread]: On master: COMMIT
[0m23:44:28.228595 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:44:28.228920 [debug] [MainThread]: On master: Close
[0m23:44:28.229345 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:44:28.229597 [debug] [MainThread]: Connection 'list_dbt_test' was properly closed.
[0m23:44:28.229820 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635' was properly closed.
[0m23:44:28.230178 [info ] [MainThread]: 
[0m23:44:28.230513 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m23:44:28.231795 [debug] [MainThread]: Command end result
[0m23:44:28.324265 [info ] [MainThread]: 
[0m23:44:28.325216 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:44:28.325958 [info ] [MainThread]: 
[0m23:44:28.326500 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m23:44:28.327649 [debug] [MainThread]: Command `cli test` succeeded at 23:44:28.327441 after 3.14 seconds
[0m23:44:28.328103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001710832FCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171086E5F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171086E60D0>]}
[0m23:44:28.328491 [debug] [MainThread]: Flushing usage events
[0m23:48:05.537868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001774A562660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001774CFA8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001774CECF750>]}


============================== 23:48:05.542303 | 329dba65-9dfb-4315-a97e-ce0191e6c3c6 ==============================
[0m23:48:05.542303 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:48:05.543059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\rodrigo.carpi\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\rodrigo.carpi\\Documents\\Personal\\Estudio\\dbt\\jaffle_shop\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select source:jaffle_shop.customers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:48:05.781944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '329dba65-9dfb-4315-a97e-ce0191e6c3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001774D602650>]}
[0m23:48:05.831620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '329dba65-9dfb-4315-a97e-ce0191e6c3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001774CF56E00>]}
[0m23:48:05.832740 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:48:06.176341 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:48:06.261821 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m23:48:06.262767 [debug] [MainThread]: previous checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, current checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995
[0m23:48:06.263235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '329dba65-9dfb-4315-a97e-ce0191e6c3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001774D4F1450>]}
[0m23:48:07.139204 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:48:07.139973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '329dba65-9dfb-4315-a97e-ce0191e6c3c6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001774D58DE50>]}
[0m23:48:07.422127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '329dba65-9dfb-4315-a97e-ce0191e6c3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001774D5F0D70>]}
[0m23:48:07.532777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '329dba65-9dfb-4315-a97e-ce0191e6c3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001774ED84FC0>]}
[0m23:48:07.533322 [info ] [MainThread]: Found 3 models, 12 data tests, 2 sources, 428 macros
[0m23:48:07.533825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '329dba65-9dfb-4315-a97e-ce0191e6c3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001774EC23D10>]}
[0m23:48:07.535584 [info ] [MainThread]: 
[0m23:48:07.536307 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:48:07.540535 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m23:48:07.631170 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m23:48:07.631562 [debug] [ThreadPool]: On list_dbt_test: BEGIN
[0m23:48:07.631861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:07.755748 [debug] [ThreadPool]: SQL status: BEGIN in 0.124 seconds
[0m23:48:07.756223 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m23:48:07.756501 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_test"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'test'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'test'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'test'
  
[0m23:48:07.761218 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m23:48:07.763341 [debug] [ThreadPool]: On list_dbt_test: ROLLBACK
[0m23:48:07.764217 [debug] [ThreadPool]: On list_dbt_test: Close
[0m23:48:07.769523 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:07.769920 [debug] [MainThread]: On master: BEGIN
[0m23:48:07.770168 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:48:07.879505 [debug] [MainThread]: SQL status: BEGIN in 0.109 seconds
[0m23:48:07.879905 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:07.880240 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:48:07.889372 [debug] [MainThread]: SQL status: SELECT 10 in 0.009 seconds
[0m23:48:07.891249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '329dba65-9dfb-4315-a97e-ce0191e6c3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001774EC7BE30>]}
[0m23:48:07.891711 [debug] [MainThread]: On master: ROLLBACK
[0m23:48:07.892297 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:07.892587 [debug] [MainThread]: On master: BEGIN
[0m23:48:07.893327 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:48:07.893761 [debug] [MainThread]: On master: COMMIT
[0m23:48:07.894126 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:07.894420 [debug] [MainThread]: On master: COMMIT
[0m23:48:07.894986 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:48:07.895339 [debug] [MainThread]: On master: Close
[0m23:48:07.895846 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:48:07.896660 [info ] [MainThread]: 
[0m23:48:07.899899 [debug] [Thread-1 (]: Began running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
[0m23:48:07.900426 [info ] [Thread-1 (]: 1 of 2 START test source_not_null_jaffle_shop_customers_id ..................... [RUN]
[0m23:48:07.901134 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f'
[0m23:48:07.901497 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
[0m23:48:07.920077 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
[0m23:48:07.921354 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
[0m23:48:07.935371 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
[0m23:48:07.936762 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
[0m23:48:07.937170 [debug] [Thread-1 (]: On test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f: BEGIN
[0m23:48:07.937480 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:48:08.047681 [debug] [Thread-1 (]: SQL status: BEGIN in 0.110 seconds
[0m23:48:08.048114 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
[0m23:48:08.048442 [debug] [Thread-1 (]: On test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."source"."customers"
where id is null



      
    ) dbt_internal_test
[0m23:48:08.050335 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:48:08.054682 [debug] [Thread-1 (]: On test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f: ROLLBACK
[0m23:48:08.055435 [debug] [Thread-1 (]: On test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f: Close
[0m23:48:08.056084 [info ] [Thread-1 (]: 1 of 2 PASS source_not_null_jaffle_shop_customers_id ........................... [[32mPASS[0m in 0.16s]
[0m23:48:08.057110 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
[0m23:48:08.057606 [debug] [Thread-1 (]: Began running node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
[0m23:48:08.058281 [info ] [Thread-1 (]: 2 of 2 START test source_unique_jaffle_shop_customers_id ....................... [RUN]
[0m23:48:08.058986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f, now test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e)
[0m23:48:08.059361 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
[0m23:48:08.065909 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
[0m23:48:08.067426 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
[0m23:48:08.069390 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
[0m23:48:08.070635 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
[0m23:48:08.071040 [debug] [Thread-1 (]: On test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e: BEGIN
[0m23:48:08.071336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:08.177659 [debug] [Thread-1 (]: SQL status: BEGIN in 0.106 seconds
[0m23:48:08.178199 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
[0m23:48:08.178590 [debug] [Thread-1 (]: On test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."source"."customers"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:48:08.181132 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:48:08.182934 [debug] [Thread-1 (]: On test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e: ROLLBACK
[0m23:48:08.183692 [debug] [Thread-1 (]: On test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e: Close
[0m23:48:08.184305 [info ] [Thread-1 (]: 2 of 2 PASS source_unique_jaffle_shop_customers_id ............................. [[32mPASS[0m in 0.13s]
[0m23:48:08.185632 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
[0m23:48:08.187109 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:08.187465 [debug] [MainThread]: On master: BEGIN
[0m23:48:08.187723 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:48:08.291493 [debug] [MainThread]: SQL status: BEGIN in 0.104 seconds
[0m23:48:08.291955 [debug] [MainThread]: On master: COMMIT
[0m23:48:08.292223 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:08.292473 [debug] [MainThread]: On master: COMMIT
[0m23:48:08.293002 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:48:08.293332 [debug] [MainThread]: On master: Close
[0m23:48:08.293940 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:48:08.294363 [debug] [MainThread]: Connection 'list_dbt_test' was properly closed.
[0m23:48:08.294643 [debug] [MainThread]: Connection 'test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e' was properly closed.
[0m23:48:08.295089 [info ] [MainThread]: 
[0m23:48:08.295642 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m23:48:08.297235 [debug] [MainThread]: Command end result
[0m23:48:08.324948 [info ] [MainThread]: 
[0m23:48:08.325591 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:48:08.326102 [info ] [MainThread]: 
[0m23:48:08.326563 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:48:08.328208 [debug] [MainThread]: Command `dbt test` succeeded at 23:48:08.327808 after 2.93 seconds
[0m23:48:08.329204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001774F06B390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001774ED356D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001774E99A0D0>]}
[0m23:48:08.329685 [debug] [MainThread]: Flushing usage events
[0m23:49:35.709334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB5172A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB4DFB890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB7B947D0>]}


============================== 23:49:35.713332 | d2677f97-539a-4f98-825f-f2e584716b1a ==============================
[0m23:49:35.713332 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:49:35.713853 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\rodrigo.carpi\\.dbt', 'log_path': 'c:\\Users\\rodrigo.carpi\\Documents\\Personal\\Estudio\\dbt\\jaffle_shop\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:49:35.968390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2677f97-539a-4f98-825f-f2e584716b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB824A520>]}
[0m23:49:36.018585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2677f97-539a-4f98-825f-f2e584716b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB7B76690>]}
[0m23:49:36.019757 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:49:36.304311 [debug] [MainThread]: checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, vars: {}, profile: , target: dev, version: 1.8.9
[0m23:49:36.395303 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m23:49:36.395799 [debug] [MainThread]: previous checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, current checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1
[0m23:49:36.396085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd2677f97-539a-4f98-825f-f2e584716b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB959C850>]}
[0m23:49:37.393333 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:49:37.393869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd2677f97-539a-4f98-825f-f2e584716b1a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB8175040>]}
[0m23:49:37.681035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2677f97-539a-4f98-825f-f2e584716b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB8234750>]}
[0m23:49:37.803287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2677f97-539a-4f98-825f-f2e584716b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB99C9090>]}
[0m23:49:37.803883 [info ] [MainThread]: Found 3 models, 12 data tests, 2 sources, 428 macros
[0m23:49:37.807192 [info ] [MainThread]: 
[0m23:49:37.807798 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:49:37.813024 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m23:49:37.904049 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m23:49:37.904454 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m23:49:37.904715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:38.018175 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.113 seconds
[0m23:49:38.019747 [debug] [ThreadPool]: On list_dbt: Close
[0m23:49:38.021768 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m23:49:38.027470 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m23:49:38.027860 [debug] [ThreadPool]: On list_dbt_test: BEGIN
[0m23:49:38.028108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:38.152632 [debug] [ThreadPool]: SQL status: BEGIN in 0.124 seconds
[0m23:49:38.153377 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m23:49:38.153982 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_test"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'test'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'test'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'test'
  
[0m23:49:38.164166 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m23:49:38.166409 [debug] [ThreadPool]: On list_dbt_test: ROLLBACK
[0m23:49:38.167125 [debug] [ThreadPool]: On list_dbt_test: Close
[0m23:49:38.172102 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:38.172499 [debug] [MainThread]: On master: BEGIN
[0m23:49:38.172751 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:49:38.292984 [debug] [MainThread]: SQL status: BEGIN in 0.120 seconds
[0m23:49:38.293454 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:38.294188 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:49:38.303811 [debug] [MainThread]: SQL status: SELECT 10 in 0.009 seconds
[0m23:49:38.305553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2677f97-539a-4f98-825f-f2e584716b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB9979D90>]}
[0m23:49:38.305963 [debug] [MainThread]: On master: ROLLBACK
[0m23:49:38.306596 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:38.306902 [debug] [MainThread]: On master: BEGIN
[0m23:49:38.307561 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:49:38.307919 [debug] [MainThread]: On master: COMMIT
[0m23:49:38.308190 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:38.308437 [debug] [MainThread]: On master: COMMIT
[0m23:49:38.308913 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:49:38.309268 [debug] [MainThread]: On master: Close
[0m23:49:38.309715 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:49:38.310050 [info ] [MainThread]: 
[0m23:49:38.313848 [debug] [Thread-1 (]: Began running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
[0m23:49:38.314380 [info ] [Thread-1 (]: 1 of 15 START test source_not_null_jaffle_shop_customers_id .................... [RUN]
[0m23:49:38.315146 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f'
[0m23:49:38.316035 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
[0m23:49:38.331551 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
[0m23:49:38.332994 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
[0m23:49:38.352005 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
[0m23:49:38.353195 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
[0m23:49:38.353585 [debug] [Thread-1 (]: On test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f: BEGIN
[0m23:49:38.353884 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:49:38.463473 [debug] [Thread-1 (]: SQL status: BEGIN in 0.109 seconds
[0m23:49:38.463974 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"
[0m23:49:38.464311 [debug] [Thread-1 (]: On test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."source"."customers"
where id is null



      
    ) dbt_internal_test
[0m23:49:38.467391 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:49:38.471614 [debug] [Thread-1 (]: On test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f: ROLLBACK
[0m23:49:38.472401 [debug] [Thread-1 (]: On test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f: Close
[0m23:49:38.473055 [info ] [Thread-1 (]: 1 of 15 PASS source_not_null_jaffle_shop_customers_id .......................... [[32mPASS[0m in 0.16s]
[0m23:49:38.473714 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f
[0m23:49:38.474160 [debug] [Thread-1 (]: Began running node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
[0m23:49:38.474737 [info ] [Thread-1 (]: 2 of 15 START test source_not_null_jaffle_shop_orders_id ....................... [RUN]
[0m23:49:38.475277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.source_not_null_jaffle_shop_customers_id.50aa22178f, now test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13)
[0m23:49:38.475694 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
[0m23:49:38.479346 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"
[0m23:49:38.480461 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
[0m23:49:38.483180 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"
[0m23:49:38.484965 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"
[0m23:49:38.485483 [debug] [Thread-1 (]: On test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13: BEGIN
[0m23:49:38.485835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:38.614355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.128 seconds
[0m23:49:38.614889 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"
[0m23:49:38.615480 [debug] [Thread-1 (]: On test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."source"."orders"
where id is null



      
    ) dbt_internal_test
[0m23:49:38.625803 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m23:49:38.627868 [debug] [Thread-1 (]: On test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13: ROLLBACK
[0m23:49:38.628791 [debug] [Thread-1 (]: On test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13: Close
[0m23:49:38.629581 [info ] [Thread-1 (]: 2 of 15 PASS source_not_null_jaffle_shop_orders_id ............................. [[32mPASS[0m in 0.15s]
[0m23:49:38.630468 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13
[0m23:49:38.631080 [debug] [Thread-1 (]: Began running node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
[0m23:49:38.631899 [info ] [Thread-1 (]: 3 of 15 START test source_unique_jaffle_shop_customers_id ...................... [RUN]
[0m23:49:38.632914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.source_not_null_jaffle_shop_orders_id.f924998b13, now test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e)
[0m23:49:38.633714 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
[0m23:49:38.640654 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
[0m23:49:38.641616 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
[0m23:49:38.643766 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
[0m23:49:38.644743 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
[0m23:49:38.645114 [debug] [Thread-1 (]: On test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e: BEGIN
[0m23:49:38.645408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:38.756328 [debug] [Thread-1 (]: SQL status: BEGIN in 0.111 seconds
[0m23:49:38.757132 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"
[0m23:49:38.757466 [debug] [Thread-1 (]: On test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."source"."customers"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:49:38.760095 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:49:38.762779 [debug] [Thread-1 (]: On test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e: ROLLBACK
[0m23:49:38.763484 [debug] [Thread-1 (]: On test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e: Close
[0m23:49:38.764077 [info ] [Thread-1 (]: 3 of 15 PASS source_unique_jaffle_shop_customers_id ............................ [[32mPASS[0m in 0.13s]
[0m23:49:38.764712 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e
[0m23:49:38.765382 [debug] [Thread-1 (]: Began running node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
[0m23:49:38.766345 [info ] [Thread-1 (]: 4 of 15 START test source_unique_jaffle_shop_orders_id ......................... [RUN]
[0m23:49:38.767644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.source_unique_jaffle_shop_customers_id.2777a7933e, now test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba)
[0m23:49:38.768269 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
[0m23:49:38.771790 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"
[0m23:49:38.772857 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
[0m23:49:38.775389 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"
[0m23:49:38.776527 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"
[0m23:49:38.776968 [debug] [Thread-1 (]: On test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba: BEGIN
[0m23:49:38.777298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:38.892143 [debug] [Thread-1 (]: SQL status: BEGIN in 0.115 seconds
[0m23:49:38.892688 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"
[0m23:49:38.893011 [debug] [Thread-1 (]: On test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."source"."orders"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:49:38.938172 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.045 seconds
[0m23:49:38.939872 [debug] [Thread-1 (]: On test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba: ROLLBACK
[0m23:49:38.940742 [debug] [Thread-1 (]: On test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba: Close
[0m23:49:38.942169 [info ] [Thread-1 (]: 4 of 15 PASS source_unique_jaffle_shop_orders_id ............................... [[32mPASS[0m in 0.17s]
[0m23:49:38.943187 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba
[0m23:49:38.943685 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_jaffle_shop__customers
[0m23:49:38.944555 [info ] [Thread-1 (]: 5 of 15 START sql view model test.stg_jaffle_shop__customers ................... [RUN]
[0m23:49:38.945176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.source_unique_jaffle_shop_orders_id.8a425b2fba, now model.jaffle_shop.stg_jaffle_shop__customers)
[0m23:49:38.945588 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_jaffle_shop__customers
[0m23:49:38.947986 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_jaffle_shop__customers"
[0m23:49:38.949604 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_jaffle_shop__customers
[0m23:49:38.986612 [debug] [Thread-1 (]: Applying DROP to: "dbt"."test"."stg_jaffle_shop__customers__dbt_backup"
[0m23:49:38.991586 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m23:49:38.992069 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__customers"} */
drop view if exists "dbt"."test"."stg_jaffle_shop__customers__dbt_backup" cascade
[0m23:49:38.992392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:39.131722 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.139 seconds
[0m23:49:39.138722 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_jaffle_shop__customers"
[0m23:49:39.139748 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m23:49:39.140149 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: BEGIN
[0m23:49:39.140929 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m23:49:39.141318 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m23:49:39.141635 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__customers"} */

  create view "dbt"."test"."stg_jaffle_shop__customers__dbt_tmp"
    
    
  as (
    select
     trim(id)   as id
    ,trim(name) as name
from "dbt"."source"."customers"
  );
[0m23:49:39.147450 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:49:39.154665 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m23:49:39.155100 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__customers"} */
alter table "dbt"."test"."stg_jaffle_shop__customers" rename to "stg_jaffle_shop__customers__dbt_backup"
[0m23:49:39.156327 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:39.158837 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m23:49:39.159220 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__customers"} */
alter table "dbt"."test"."stg_jaffle_shop__customers__dbt_tmp" rename to "stg_jaffle_shop__customers"
[0m23:49:39.160142 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:39.176020 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: COMMIT
[0m23:49:39.176459 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m23:49:39.176769 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: COMMIT
[0m23:49:39.179189 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:49:39.181639 [debug] [Thread-1 (]: Applying DROP to: "dbt"."test"."stg_jaffle_shop__customers__dbt_backup"
[0m23:49:39.182534 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__customers"
[0m23:49:39.183060 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__customers"} */
drop view if exists "dbt"."test"."stg_jaffle_shop__customers__dbt_backup" cascade
[0m23:49:39.184744 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:49:39.186249 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__customers: Close
[0m23:49:39.187701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2677f97-539a-4f98-825f-f2e584716b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB99752E0>]}
[0m23:49:39.188338 [info ] [Thread-1 (]: 5 of 15 OK created sql view model test.stg_jaffle_shop__customers .............. [[32mCREATE VIEW[0m in 0.24s]
[0m23:49:39.188960 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_jaffle_shop__customers
[0m23:49:39.189415 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_jaffle_shop__orders
[0m23:49:39.190155 [info ] [Thread-1 (]: 6 of 15 START sql view model test.stg_jaffle_shop__orders ...................... [RUN]
[0m23:49:39.190892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_jaffle_shop__customers, now model.jaffle_shop.stg_jaffle_shop__orders)
[0m23:49:39.191364 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_jaffle_shop__orders
[0m23:49:39.193783 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_jaffle_shop__orders"
[0m23:49:39.195229 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_jaffle_shop__orders
[0m23:49:39.200765 [debug] [Thread-1 (]: Applying DROP to: "dbt"."test"."stg_jaffle_shop__orders__dbt_backup"
[0m23:49:39.201499 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__orders"
[0m23:49:39.201840 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__orders"} */
drop view if exists "dbt"."test"."stg_jaffle_shop__orders__dbt_backup" cascade
[0m23:49:39.202145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:39.425176 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.223 seconds
[0m23:49:39.427155 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_jaffle_shop__orders"
[0m23:49:39.428137 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__orders"
[0m23:49:39.428539 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: BEGIN
[0m23:49:39.429229 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m23:49:39.429627 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__orders"
[0m23:49:39.429958 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__orders"} */

  create view "dbt"."test"."stg_jaffle_shop__orders__dbt_tmp"
    
    
  as (
    select
     trim(id)                               as id
    ,trim(customer)                         as customer_id
    ,cast(trim(ordered_at) as timestamp)    as ordered_at
    ,trim(store_id)                         as store_id
    ,cast(trim(subtotal) as integer)        as subtotal
    ,cast(trim(tax_paid) as integer)        as tax_paid
    ,cast(trim(order_total) as integer)     as order_total
from "dbt"."source"."orders"
  );
[0m23:49:39.432738 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:49:39.435562 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__orders"
[0m23:49:39.435956 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__orders"} */
alter table "dbt"."test"."stg_jaffle_shop__orders" rename to "stg_jaffle_shop__orders__dbt_backup"
[0m23:49:39.437096 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:39.439666 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__orders"
[0m23:49:39.440061 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__orders"} */
alter table "dbt"."test"."stg_jaffle_shop__orders__dbt_tmp" rename to "stg_jaffle_shop__orders"
[0m23:49:39.441254 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:39.442745 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: COMMIT
[0m23:49:39.443093 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__orders"
[0m23:49:39.443394 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: COMMIT
[0m23:49:39.446440 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:49:39.448996 [debug] [Thread-1 (]: Applying DROP to: "dbt"."test"."stg_jaffle_shop__orders__dbt_backup"
[0m23:49:39.449924 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_jaffle_shop__orders"
[0m23:49:39.450440 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_jaffle_shop__orders"} */
drop view if exists "dbt"."test"."stg_jaffle_shop__orders__dbt_backup" cascade
[0m23:49:39.451894 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:49:39.453289 [debug] [Thread-1 (]: On model.jaffle_shop.stg_jaffle_shop__orders: Close
[0m23:49:39.453851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2677f97-539a-4f98-825f-f2e584716b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FABA14AB70>]}
[0m23:49:39.454438 [info ] [Thread-1 (]: 6 of 15 OK created sql view model test.stg_jaffle_shop__orders ................. [[32mCREATE VIEW[0m in 0.26s]
[0m23:49:39.455100 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_jaffle_shop__orders
[0m23:49:39.455528 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9
[0m23:49:39.456198 [info ] [Thread-1 (]: 7 of 15 START test not_null_stg_jaffle_shop__customers_id ...................... [RUN]
[0m23:49:39.456899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_jaffle_shop__orders, now test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9)
[0m23:49:39.457357 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9
[0m23:49:39.461019 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9"
[0m23:49:39.461896 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9
[0m23:49:39.463805 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9"
[0m23:49:39.464715 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9"
[0m23:49:39.465237 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9: BEGIN
[0m23:49:39.465708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:39.574683 [debug] [Thread-1 (]: SQL status: BEGIN in 0.109 seconds
[0m23:49:39.575123 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9"
[0m23:49:39.575446 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."test"."stg_jaffle_shop__customers"
where id is null



      
    ) dbt_internal_test
[0m23:49:39.577807 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:49:39.579310 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9: ROLLBACK
[0m23:49:39.580177 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9: Close
[0m23:49:39.581454 [info ] [Thread-1 (]: 7 of 15 PASS not_null_stg_jaffle_shop__customers_id ............................ [[32mPASS[0m in 0.12s]
[0m23:49:39.582626 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9
[0m23:49:39.583233 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d
[0m23:49:39.583613 [info ] [Thread-1 (]: 8 of 15 START test not_null_stg_jaffle_shop__customers_name .................... [RUN]
[0m23:49:39.584304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_jaffle_shop__customers_id.9fe54e91a9, now test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d)
[0m23:49:39.584695 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d
[0m23:49:39.588711 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d"
[0m23:49:39.589647 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d
[0m23:49:39.591598 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d"
[0m23:49:39.592495 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d"
[0m23:49:39.592905 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d: BEGIN
[0m23:49:39.593225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:39.722289 [debug] [Thread-1 (]: SQL status: BEGIN in 0.129 seconds
[0m23:49:39.723051 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d"
[0m23:49:39.723374 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "dbt"."test"."stg_jaffle_shop__customers"
where name is null



      
    ) dbt_internal_test
[0m23:49:39.725418 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:49:39.726950 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d: ROLLBACK
[0m23:49:39.727730 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d: Close
[0m23:49:39.728662 [info ] [Thread-1 (]: 8 of 15 PASS not_null_stg_jaffle_shop__customers_name .......................... [[32mPASS[0m in 0.14s]
[0m23:49:39.729562 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d
[0m23:49:39.730139 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788
[0m23:49:39.730618 [info ] [Thread-1 (]: 9 of 15 START test unique_stg_jaffle_shop__customers_id ........................ [RUN]
[0m23:49:39.731237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_jaffle_shop__customers_name.067d14a37d, now test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788)
[0m23:49:39.731945 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788
[0m23:49:39.737311 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788"
[0m23:49:39.738566 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788
[0m23:49:39.741331 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788"
[0m23:49:39.742387 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788"
[0m23:49:39.742844 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788: BEGIN
[0m23:49:39.743200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:39.961551 [debug] [Thread-1 (]: SQL status: BEGIN in 0.218 seconds
[0m23:49:39.962032 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788"
[0m23:49:39.962370 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."test"."stg_jaffle_shop__customers"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:49:39.965920 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:49:39.967607 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788: ROLLBACK
[0m23:49:39.968267 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788: Close
[0m23:49:39.968887 [info ] [Thread-1 (]: 9 of 15 PASS unique_stg_jaffle_shop__customers_id .............................. [[32mPASS[0m in 0.24s]
[0m23:49:39.969546 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788
[0m23:49:39.969984 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832
[0m23:49:39.970857 [info ] [Thread-1 (]: 10 of 15 START test not_null_stg_jaffle_shop__orders_customer_id ............... [RUN]
[0m23:49:39.971748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_jaffle_shop__customers_id.daf2353788, now test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832)
[0m23:49:39.972201 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832
[0m23:49:39.975605 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832"
[0m23:49:39.976504 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832
[0m23:49:39.979089 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832"
[0m23:49:39.980046 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832"
[0m23:49:39.980432 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832: BEGIN
[0m23:49:39.980749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:40.093712 [debug] [Thread-1 (]: SQL status: BEGIN in 0.113 seconds
[0m23:49:40.094164 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832"
[0m23:49:40.094494 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dbt"."test"."stg_jaffle_shop__orders"
where customer_id is null



      
    ) dbt_internal_test
[0m23:49:40.115732 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.021 seconds
[0m23:49:40.117985 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832: ROLLBACK
[0m23:49:40.118924 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832: Close
[0m23:49:40.119685 [info ] [Thread-1 (]: 10 of 15 PASS not_null_stg_jaffle_shop__orders_customer_id ..................... [[32mPASS[0m in 0.15s]
[0m23:49:40.120445 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832
[0m23:49:40.120913 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea
[0m23:49:40.121424 [info ] [Thread-1 (]: 11 of 15 START test not_null_stg_jaffle_shop__orders_id ........................ [RUN]
[0m23:49:40.121928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832, now test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea)
[0m23:49:40.122280 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea
[0m23:49:40.125666 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea"
[0m23:49:40.126567 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea
[0m23:49:40.128444 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea"
[0m23:49:40.129294 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea"
[0m23:49:40.129693 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea: BEGIN
[0m23:49:40.129996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:40.267498 [debug] [Thread-1 (]: SQL status: BEGIN in 0.137 seconds
[0m23:49:40.267959 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea"
[0m23:49:40.268278 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."test"."stg_jaffle_shop__orders"
where id is null



      
    ) dbt_internal_test
[0m23:49:40.288376 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.019 seconds
[0m23:49:40.290880 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea: ROLLBACK
[0m23:49:40.291788 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea: Close
[0m23:49:40.292432 [info ] [Thread-1 (]: 11 of 15 PASS not_null_stg_jaffle_shop__orders_id .............................. [[32mPASS[0m in 0.17s]
[0m23:49:40.293049 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea
[0m23:49:40.293454 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75
[0m23:49:40.293991 [info ] [Thread-1 (]: 12 of 15 START test not_null_stg_jaffle_shop__orders_ordered_at ................ [RUN]
[0m23:49:40.294498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea, now test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75)
[0m23:49:40.294836 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75
[0m23:49:40.298511 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75"
[0m23:49:40.299780 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75
[0m23:49:40.302073 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75"
[0m23:49:40.303019 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75"
[0m23:49:40.303442 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75: BEGIN
[0m23:49:40.303780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:40.410042 [debug] [Thread-1 (]: SQL status: BEGIN in 0.106 seconds
[0m23:49:40.410674 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75"
[0m23:49:40.411340 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ordered_at
from "dbt"."test"."stg_jaffle_shop__orders"
where ordered_at is null



      
    ) dbt_internal_test
[0m23:49:40.580343 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.168 seconds
[0m23:49:40.582204 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75: ROLLBACK
[0m23:49:40.583115 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75: Close
[0m23:49:40.584179 [info ] [Thread-1 (]: 12 of 15 PASS not_null_stg_jaffle_shop__orders_ordered_at ...................... [[32mPASS[0m in 0.29s]
[0m23:49:40.585005 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75
[0m23:49:40.585550 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9
[0m23:49:40.586075 [info ] [Thread-1 (]: 13 of 15 START test not_null_stg_jaffle_shop__orders_store_id .................. [RUN]
[0m23:49:40.586643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75, now test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9)
[0m23:49:40.587001 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9
[0m23:49:40.590389 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9"
[0m23:49:40.591300 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9
[0m23:49:40.595444 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9"
[0m23:49:40.596395 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9"
[0m23:49:40.596777 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9: BEGIN
[0m23:49:40.597088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:40.702782 [debug] [Thread-1 (]: SQL status: BEGIN in 0.105 seconds
[0m23:49:40.703298 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9"
[0m23:49:40.703620 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "dbt"."test"."stg_jaffle_shop__orders"
where store_id is null



      
    ) dbt_internal_test
[0m23:49:40.726299 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.022 seconds
[0m23:49:40.728459 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9: ROLLBACK
[0m23:49:40.729580 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9: Close
[0m23:49:40.730295 [info ] [Thread-1 (]: 13 of 15 PASS not_null_stg_jaffle_shop__orders_store_id ........................ [[32mPASS[0m in 0.14s]
[0m23:49:40.731017 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9
[0m23:49:40.732028 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635
[0m23:49:40.732818 [info ] [Thread-1 (]: 14 of 15 START test unique_stg_jaffle_shop__orders_id .......................... [RUN]
[0m23:49:40.733488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9, now test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635)
[0m23:49:40.733928 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635
[0m23:49:40.737360 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635"
[0m23:49:40.738233 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635
[0m23:49:40.740053 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635"
[0m23:49:40.740900 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635"
[0m23:49:40.741252 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635: BEGIN
[0m23:49:40.741544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:40.863287 [debug] [Thread-1 (]: SQL status: BEGIN in 0.122 seconds
[0m23:49:40.863736 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635"
[0m23:49:40.864059 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."test"."stg_jaffle_shop__orders"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:49:40.933535 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.069 seconds
[0m23:49:40.935287 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635: ROLLBACK
[0m23:49:40.935962 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635: Close
[0m23:49:40.936606 [info ] [Thread-1 (]: 14 of 15 PASS unique_stg_jaffle_shop__orders_id ................................ [[32mPASS[0m in 0.20s]
[0m23:49:40.937357 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635
[0m23:49:40.938161 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m23:49:40.938741 [info ] [Thread-1 (]: 15 of 15 START sql table model test.dim_customers .............................. [RUN]
[0m23:49:40.939469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635, now model.jaffle_shop.dim_customers)
[0m23:49:40.940315 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m23:49:40.943386 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m23:49:40.944409 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m23:49:40.964598 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m23:49:40.966008 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:49:40.966522 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m23:49:40.966920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:49:41.086487 [debug] [Thread-1 (]: SQL status: BEGIN in 0.119 seconds
[0m23:49:41.086951 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:49:41.087295 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    

  create  table "dbt"."test"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select
         customer_id
        ,min(ordered_at)    as first_order_date
        ,max(ordered_at)    as last_order_date
        ,count(distinct id) as number_of_orders
        ,sum(subtotal)      as lifetime_spend_pretax
        ,sum(tax_paid)      as lifetime_tax_paid
        ,sum(order_total)   as lifetime_spend
    from "dbt"."test"."stg_jaffle_shop__orders"
    group by 1
)
select
     cst.id
    ,cst.name
    ,ord.first_order_date
    ,ord.last_order_date
    ,coalesce(ord.number_of_orders      , 0) as number_of_orders
    ,coalesce(ord.lifetime_spend_pretax , 0) as lifetime_spend_pretax
    ,coalesce(ord.lifetime_tax_paid     , 0) as lifetime_tax_paid
    ,coalesce(ord.lifetime_spend        , 0) as lifetime_spend
from "dbt"."test"."stg_jaffle_shop__customers" as cst
left join orders as ord
    on cst.id = ord.customer_id
  );
  
[0m23:49:41.878799 [debug] [Thread-1 (]: SQL status: SELECT 930 in 0.791 seconds
[0m23:49:41.881949 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:49:41.882511 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."test"."dim_customers" rename to "dim_customers__dbt_backup"
[0m23:49:41.884814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:49:41.887456 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:49:41.887841 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."test"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m23:49:41.889123 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:49:41.894281 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m23:49:41.894701 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:49:41.895000 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m23:49:41.896180 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:49:41.899444 [debug] [Thread-1 (]: Applying DROP to: "dbt"."test"."dim_customers__dbt_backup"
[0m23:49:41.902267 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:49:41.902722 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbt"."test"."dim_customers__dbt_backup" cascade
[0m23:49:41.904648 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:49:41.905944 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m23:49:41.906522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2677f97-539a-4f98-825f-f2e584716b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB9C75350>]}
[0m23:49:41.907089 [info ] [Thread-1 (]: 15 of 15 OK created sql table model test.dim_customers ......................... [[32mSELECT 930[0m in 0.97s]
[0m23:49:41.907699 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m23:49:41.909145 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:41.909553 [debug] [MainThread]: On master: BEGIN
[0m23:49:41.909819 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:49:42.022172 [debug] [MainThread]: SQL status: BEGIN in 0.112 seconds
[0m23:49:42.022601 [debug] [MainThread]: On master: COMMIT
[0m23:49:42.022859 [debug] [MainThread]: Using postgres connection "master"
[0m23:49:42.023108 [debug] [MainThread]: On master: COMMIT
[0m23:49:42.023652 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:49:42.023976 [debug] [MainThread]: On master: Close
[0m23:49:42.024391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:49:42.024681 [debug] [MainThread]: Connection 'list_dbt' was properly closed.
[0m23:49:42.024957 [debug] [MainThread]: Connection 'list_dbt_test' was properly closed.
[0m23:49:42.025180 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m23:49:42.025589 [info ] [MainThread]: 
[0m23:49:42.025944 [info ] [MainThread]: Finished running 12 data tests, 2 view models, 1 table model in 0 hours 0 minutes and 4.22 seconds (4.22s).
[0m23:49:42.028766 [debug] [MainThread]: Command end result
[0m23:49:42.057952 [info ] [MainThread]: 
[0m23:49:42.058443 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:49:42.058801 [info ] [MainThread]: 
[0m23:49:42.059115 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m23:49:42.060121 [debug] [MainThread]: Command `cli build` succeeded at 23:49:42.059965 after 6.53 seconds
[0m23:49:42.060504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB7D411D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB18BAD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAB69FBCB0>]}
[0m23:49:42.060823 [debug] [MainThread]: Flushing usage events
[0m23:53:44.717140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002419E6BEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002419E34B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241A10E47D0>]}


============================== 23:53:44.721170 | fb5edcf1-d972-4006-b2a8-de4ca3e3df87 ==============================
[0m23:53:44.721170 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:53:44.721712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\rodrigo.carpi\\Documents\\Personal\\Estudio\\dbt\\jaffle_shop\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\rodrigo.carpi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:53:44.960821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb5edcf1-d972-4006-b2a8-de4ca3e3df87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241A179A520>]}
[0m23:53:45.007989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb5edcf1-d972-4006-b2a8-de4ca3e3df87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241A10C68B0>]}
[0m23:53:45.009121 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:53:45.294289 [debug] [MainThread]: checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, vars: {}, profile: , target: dev, version: 1.8.9
[0m23:53:45.440069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:53:45.440788 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models\staging\stg_jaffle_shop__orders.yml
[0m23:53:45.632921 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:53:45.633458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fb5edcf1-d972-4006-b2a8-de4ca3e3df87', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241A168F350>]}
[0m23:53:45.805126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb5edcf1-d972-4006-b2a8-de4ca3e3df87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241A2B5B5C0>]}
[0m23:53:45.915094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb5edcf1-d972-4006-b2a8-de4ca3e3df87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241A296B690>]}
[0m23:53:45.915637 [info ] [MainThread]: Found 3 models, 13 data tests, 2 sources, 428 macros
[0m23:53:45.916250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb5edcf1-d972-4006-b2a8-de4ca3e3df87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241A2F1B860>]}
[0m23:53:45.918385 [info ] [MainThread]: 
[0m23:53:45.919008 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:53:45.923075 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m23:53:46.013736 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m23:53:46.014149 [debug] [ThreadPool]: On list_dbt_test: BEGIN
[0m23:53:46.014406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:46.133830 [debug] [ThreadPool]: SQL status: BEGIN in 0.119 seconds
[0m23:53:46.134311 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m23:53:46.134621 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_test"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'test'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'test'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'test'
  
[0m23:53:46.138898 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m23:53:46.140950 [debug] [ThreadPool]: On list_dbt_test: ROLLBACK
[0m23:53:46.141566 [debug] [ThreadPool]: On list_dbt_test: Close
[0m23:53:46.146819 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:46.147195 [debug] [MainThread]: On master: BEGIN
[0m23:53:46.147435 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:53:46.269812 [debug] [MainThread]: SQL status: BEGIN in 0.122 seconds
[0m23:53:46.270398 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:46.271098 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:53:46.280312 [debug] [MainThread]: SQL status: SELECT 10 in 0.009 seconds
[0m23:53:46.282305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb5edcf1-d972-4006-b2a8-de4ca3e3df87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241A2F55C10>]}
[0m23:53:46.282729 [debug] [MainThread]: On master: ROLLBACK
[0m23:53:46.283377 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:46.283794 [debug] [MainThread]: On master: BEGIN
[0m23:53:46.284996 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:53:46.285398 [debug] [MainThread]: On master: COMMIT
[0m23:53:46.285689 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:46.285934 [debug] [MainThread]: On master: COMMIT
[0m23:53:46.286395 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:53:46.286725 [debug] [MainThread]: On master: Close
[0m23:53:46.287156 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:53:46.287510 [info ] [MainThread]: 
[0m23:53:46.290642 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832
[0m23:53:46.291118 [info ] [Thread-1 (]: 1 of 6 START test not_null_stg_jaffle_shop__orders_customer_id ................. [RUN]
[0m23:53:46.291637 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832'
[0m23:53:46.292047 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832
[0m23:53:46.364032 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832"
[0m23:53:46.364964 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832
[0m23:53:46.378110 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832"
[0m23:53:46.379129 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832"
[0m23:53:46.379521 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832: BEGIN
[0m23:53:46.379819 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:53:46.595291 [debug] [Thread-1 (]: SQL status: BEGIN in 0.215 seconds
[0m23:53:46.595740 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832"
[0m23:53:46.596070 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dbt"."test"."stg_jaffle_shop__orders"
where customer_id is null



      
    ) dbt_internal_test
[0m23:53:46.617557 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.021 seconds
[0m23:53:46.621523 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832: ROLLBACK
[0m23:53:46.622534 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832: Close
[0m23:53:46.623283 [info ] [Thread-1 (]: 1 of 6 PASS not_null_stg_jaffle_shop__orders_customer_id ....................... [[32mPASS[0m in 0.33s]
[0m23:53:46.623921 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832
[0m23:53:46.624338 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea
[0m23:53:46.624949 [info ] [Thread-1 (]: 2 of 6 START test not_null_stg_jaffle_shop__orders_id .......................... [RUN]
[0m23:53:46.625487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832, now test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea)
[0m23:53:46.625860 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea
[0m23:53:46.629728 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea"
[0m23:53:46.630645 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea
[0m23:53:46.632665 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea"
[0m23:53:46.633942 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea"
[0m23:53:46.634707 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea: BEGIN
[0m23:53:46.635254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:46.751563 [debug] [Thread-1 (]: SQL status: BEGIN in 0.116 seconds
[0m23:53:46.752039 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea"
[0m23:53:46.752372 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."test"."stg_jaffle_shop__orders"
where id is null



      
    ) dbt_internal_test
[0m23:53:46.772138 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.019 seconds
[0m23:53:46.774040 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea: ROLLBACK
[0m23:53:46.774839 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea: Close
[0m23:53:46.775766 [info ] [Thread-1 (]: 2 of 6 PASS not_null_stg_jaffle_shop__orders_id ................................ [[32mPASS[0m in 0.15s]
[0m23:53:46.776909 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea
[0m23:53:46.777434 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75
[0m23:53:46.777911 [info ] [Thread-1 (]: 3 of 6 START test not_null_stg_jaffle_shop__orders_ordered_at .................. [RUN]
[0m23:53:46.778388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea, now test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75)
[0m23:53:46.778743 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75
[0m23:53:46.782218 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75"
[0m23:53:46.783188 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75
[0m23:53:46.785941 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75"
[0m23:53:46.786847 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75"
[0m23:53:46.787213 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75: BEGIN
[0m23:53:46.787506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:46.904921 [debug] [Thread-1 (]: SQL status: BEGIN in 0.117 seconds
[0m23:53:46.905359 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75"
[0m23:53:46.905678 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ordered_at
from "dbt"."test"."stg_jaffle_shop__orders"
where ordered_at is null



      
    ) dbt_internal_test
[0m23:53:47.065832 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.160 seconds
[0m23:53:47.067530 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75: ROLLBACK
[0m23:53:47.068229 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75: Close
[0m23:53:47.068903 [info ] [Thread-1 (]: 3 of 6 PASS not_null_stg_jaffle_shop__orders_ordered_at ........................ [[32mPASS[0m in 0.29s]
[0m23:53:47.069547 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75
[0m23:53:47.070027 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9
[0m23:53:47.070494 [info ] [Thread-1 (]: 4 of 6 START test not_null_stg_jaffle_shop__orders_store_id .................... [RUN]
[0m23:53:47.070980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75, now test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9)
[0m23:53:47.071372 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9
[0m23:53:47.074797 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9"
[0m23:53:47.075707 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9
[0m23:53:47.077657 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9"
[0m23:53:47.078601 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9"
[0m23:53:47.079021 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9: BEGIN
[0m23:53:47.079358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:47.188428 [debug] [Thread-1 (]: SQL status: BEGIN in 0.109 seconds
[0m23:53:47.188872 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9"
[0m23:53:47.189200 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "dbt"."test"."stg_jaffle_shop__orders"
where store_id is null



      
    ) dbt_internal_test
[0m23:53:47.210909 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.021 seconds
[0m23:53:47.212419 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9: ROLLBACK
[0m23:53:47.213201 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9: Close
[0m23:53:47.213811 [info ] [Thread-1 (]: 4 of 6 PASS not_null_stg_jaffle_shop__orders_store_id .......................... [[32mPASS[0m in 0.14s]
[0m23:53:47.214535 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9
[0m23:53:47.215006 [debug] [Thread-1 (]: Began running node test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__customer_id__ref_stg_jaffle_shop__customers_.3e222ebf00
[0m23:53:47.215632 [info ] [Thread-1 (]: 5 of 6 START test relationships_stg_jaffle_shop__orders_customer_id__customer_id__ref_stg_jaffle_shop__customers_  [RUN]
[0m23:53:47.216247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9, now test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__customer_id__ref_stg_jaffle_shop__customers_.3e222ebf00)
[0m23:53:47.216790 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__customer_id__ref_stg_jaffle_shop__customers_.3e222ebf00
[0m23:53:47.221652 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__customer_id__ref_stg_jaffle_shop__customers_.3e222ebf00"
[0m23:53:47.222668 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__customer_id__ref_stg_jaffle_shop__customers_.3e222ebf00
[0m23:53:47.224765 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__customer_id__ref_stg_jaffle_shop__customers_.3e222ebf00"
[0m23:53:47.225850 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__customer_id__ref_stg_jaffle_shop__customers_.3e222ebf00"
[0m23:53:47.226246 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__customer_id__ref_stg_jaffle_shop__customers_.3e222ebf00: BEGIN
[0m23:53:47.226543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:47.343406 [debug] [Thread-1 (]: SQL status: BEGIN in 0.117 seconds
[0m23:53:47.343870 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__customer_id__ref_stg_jaffle_shop__customers_.3e222ebf00"
[0m23:53:47.344346 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__customer_id__ref_stg_jaffle_shop__customers_.3e222ebf00: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__customer_id__ref_stg_jaffle_shop__customers_.3e222ebf00"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "dbt"."test"."stg_jaffle_shop__orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt"."test"."stg_jaffle_shop__customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m23:53:47.359618 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no existe la columna Â«customer_idÂ»
LINE 18:     select customer_id as to_field
                    ^
[0m23:53:47.360076 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__customer_id__ref_stg_jaffle_shop__customers_.3e222ebf00: ROLLBACK
[0m23:53:47.360757 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__customer_id__ref_stg_jaffle_shop__customers_.3e222ebf00: Close
[0m23:53:47.377720 [debug] [Thread-1 (]: Database Error in test relationships_stg_jaffle_shop__orders_customer_id__customer_id__ref_stg_jaffle_shop__customers_ (models\staging\stg_jaffle_shop__orders.yml)
  no existe la columna Â«customer_idÂ»
  LINE 18:     select customer_id as to_field
                      ^
  compiled code at target\run\jaffle_shop\models\staging\stg_jaffle_shop__orders.yml\relationships_stg_jaffle_shop__69c2006accf24d593d7f144684ebb92c.sql
[0m23:53:47.378300 [error] [Thread-1 (]: 5 of 6 ERROR relationships_stg_jaffle_shop__orders_customer_id__customer_id__ref_stg_jaffle_shop__customers_  [[31mERROR[0m in 0.16s]
[0m23:53:47.378905 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__customer_id__ref_stg_jaffle_shop__customers_.3e222ebf00
[0m23:53:47.379272 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635
[0m23:53:47.380504 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_jaffle_shop__orders_id ............................ [RUN]
[0m23:53:47.381047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__customer_id__ref_stg_jaffle_shop__customers_.3e222ebf00, now test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635)
[0m23:53:47.381385 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635
[0m23:53:47.387793 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635"
[0m23:53:47.388736 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635
[0m23:53:47.390709 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635"
[0m23:53:47.391641 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635"
[0m23:53:47.392041 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635: BEGIN
[0m23:53:47.392369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:47.515111 [debug] [Thread-1 (]: SQL status: BEGIN in 0.123 seconds
[0m23:53:47.515554 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635"
[0m23:53:47.515885 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."test"."stg_jaffle_shop__orders"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:53:47.580860 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.064 seconds
[0m23:53:47.582711 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635: ROLLBACK
[0m23:53:47.583672 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635: Close
[0m23:53:47.584485 [info ] [Thread-1 (]: 6 of 6 PASS unique_stg_jaffle_shop__orders_id .................................. [[32mPASS[0m in 0.20s]
[0m23:53:47.585223 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635
[0m23:53:47.586722 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:47.587098 [debug] [MainThread]: On master: BEGIN
[0m23:53:47.587345 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:53:47.710376 [debug] [MainThread]: SQL status: BEGIN in 0.123 seconds
[0m23:53:47.711021 [debug] [MainThread]: On master: COMMIT
[0m23:53:47.711290 [debug] [MainThread]: Using postgres connection "master"
[0m23:53:47.711535 [debug] [MainThread]: On master: COMMIT
[0m23:53:47.712018 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:53:47.712354 [debug] [MainThread]: On master: Close
[0m23:53:47.712766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:53:47.713010 [debug] [MainThread]: Connection 'list_dbt_test' was properly closed.
[0m23:53:47.713254 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635' was properly closed.
[0m23:53:47.713569 [info ] [MainThread]: 
[0m23:53:47.713888 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 1.79 seconds (1.79s).
[0m23:53:47.715335 [debug] [MainThread]: Command end result
[0m23:53:47.744595 [info ] [MainThread]: 
[0m23:53:47.745195 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:53:47.745546 [info ] [MainThread]: 
[0m23:53:47.745965 [error] [MainThread]:   Database Error in test relationships_stg_jaffle_shop__orders_customer_id__customer_id__ref_stg_jaffle_shop__customers_ (models\staging\stg_jaffle_shop__orders.yml)
  no existe la columna Â«customer_idÂ»
  LINE 18:     select customer_id as to_field
                      ^
  compiled code at target\run\jaffle_shop\models\staging\stg_jaffle_shop__orders.yml\relationships_stg_jaffle_shop__69c2006accf24d593d7f144684ebb92c.sql
[0m23:53:47.746419 [info ] [MainThread]: 
[0m23:53:47.746759 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m23:53:47.747736 [debug] [MainThread]: Command `cli test` failed at 23:53:47.747592 after 3.19 seconds
[0m23:53:47.748139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241A32D5230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241A324D270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241A324E0D0>]}
[0m23:53:47.748479 [debug] [MainThread]: Flushing usage events
[0m23:54:22.550255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001848FDAEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001848FA3B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184927E47D0>]}


============================== 23:54:22.554326 | f589aef9-c5b8-4e20-90f6-8a257d190f98 ==============================
[0m23:54:22.554326 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:54:22.554868 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\rodrigo.carpi\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\rodrigo.carpi\\Documents\\Personal\\Estudio\\dbt\\jaffle_shop\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:54:22.814571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f589aef9-c5b8-4e20-90f6-8a257d190f98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018492E6A520>]}
[0m23:54:22.861119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f589aef9-c5b8-4e20-90f6-8a257d190f98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184927C68B0>]}
[0m23:54:22.863146 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:54:23.147487 [debug] [MainThread]: checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, vars: {}, profile: , target: dev, version: 1.8.9
[0m23:54:23.292464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:54:23.293194 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models\staging\stg_jaffle_shop__orders.yml
[0m23:54:23.487424 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:54:23.487928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f589aef9-c5b8-4e20-90f6-8a257d190f98', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018492D5B950>]}
[0m23:54:23.655960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f589aef9-c5b8-4e20-90f6-8a257d190f98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001849422F110>]}
[0m23:54:23.764324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f589aef9-c5b8-4e20-90f6-8a257d190f98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001849403BA10>]}
[0m23:54:23.764829 [info ] [MainThread]: Found 3 models, 13 data tests, 2 sources, 428 macros
[0m23:54:23.765174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f589aef9-c5b8-4e20-90f6-8a257d190f98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184945F75F0>]}
[0m23:54:23.766955 [info ] [MainThread]: 
[0m23:54:23.767579 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:54:23.771610 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m23:54:23.867939 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m23:54:23.868633 [debug] [ThreadPool]: On list_dbt_test: BEGIN
[0m23:54:23.869068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:23.990114 [debug] [ThreadPool]: SQL status: BEGIN in 0.121 seconds
[0m23:54:23.991068 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m23:54:23.991488 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_test"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'test'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'test'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'test'
  
[0m23:54:23.997305 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m23:54:23.999109 [debug] [ThreadPool]: On list_dbt_test: ROLLBACK
[0m23:54:23.999812 [debug] [ThreadPool]: On list_dbt_test: Close
[0m23:54:24.005198 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:24.005590 [debug] [MainThread]: On master: BEGIN
[0m23:54:24.005849 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:54:24.213895 [debug] [MainThread]: SQL status: BEGIN in 0.208 seconds
[0m23:54:24.214626 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:24.215344 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:54:24.224810 [debug] [MainThread]: SQL status: SELECT 10 in 0.009 seconds
[0m23:54:24.226770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f589aef9-c5b8-4e20-90f6-8a257d190f98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001849467D910>]}
[0m23:54:24.227181 [debug] [MainThread]: On master: ROLLBACK
[0m23:54:24.228212 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:24.229224 [debug] [MainThread]: On master: BEGIN
[0m23:54:24.230524 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:54:24.230887 [debug] [MainThread]: On master: COMMIT
[0m23:54:24.231140 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:24.231385 [debug] [MainThread]: On master: COMMIT
[0m23:54:24.231894 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:54:24.232217 [debug] [MainThread]: On master: Close
[0m23:54:24.232658 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:54:24.233001 [info ] [MainThread]: 
[0m23:54:24.235938 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832
[0m23:54:24.236418 [info ] [Thread-1 (]: 1 of 6 START test not_null_stg_jaffle_shop__orders_customer_id ................. [RUN]
[0m23:54:24.236959 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832'
[0m23:54:24.237356 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832
[0m23:54:24.310898 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832"
[0m23:54:24.311876 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832
[0m23:54:24.325290 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832"
[0m23:54:24.326525 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832"
[0m23:54:24.327085 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832: BEGIN
[0m23:54:24.327401 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:54:24.470216 [debug] [Thread-1 (]: SQL status: BEGIN in 0.143 seconds
[0m23:54:24.470899 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832"
[0m23:54:24.471365 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dbt"."test"."stg_jaffle_shop__orders"
where customer_id is null



      
    ) dbt_internal_test
[0m23:54:24.493249 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.021 seconds
[0m23:54:24.497402 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832: ROLLBACK
[0m23:54:24.498214 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832: Close
[0m23:54:24.499053 [info ] [Thread-1 (]: 1 of 6 PASS not_null_stg_jaffle_shop__orders_customer_id ....................... [[32mPASS[0m in 0.26s]
[0m23:54:24.499916 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832
[0m23:54:24.500493 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea
[0m23:54:24.501036 [info ] [Thread-1 (]: 2 of 6 START test not_null_stg_jaffle_shop__orders_id .......................... [RUN]
[0m23:54:24.501610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_jaffle_shop__orders_customer_id.50eb6d1832, now test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea)
[0m23:54:24.502119 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea
[0m23:54:24.506354 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea"
[0m23:54:24.507378 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea
[0m23:54:24.509285 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea"
[0m23:54:24.510203 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea"
[0m23:54:24.510608 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea: BEGIN
[0m23:54:24.510977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:24.619640 [debug] [Thread-1 (]: SQL status: BEGIN in 0.108 seconds
[0m23:54:24.620760 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea"
[0m23:54:24.621634 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dbt"."test"."stg_jaffle_shop__orders"
where id is null



      
    ) dbt_internal_test
[0m23:54:24.642085 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.020 seconds
[0m23:54:24.643988 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea: ROLLBACK
[0m23:54:24.644836 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea: Close
[0m23:54:24.645757 [info ] [Thread-1 (]: 2 of 6 PASS not_null_stg_jaffle_shop__orders_id ................................ [[32mPASS[0m in 0.14s]
[0m23:54:24.646682 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea
[0m23:54:24.647549 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75
[0m23:54:24.648083 [info ] [Thread-1 (]: 3 of 6 START test not_null_stg_jaffle_shop__orders_ordered_at .................. [RUN]
[0m23:54:24.648598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_jaffle_shop__orders_id.cb806202ea, now test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75)
[0m23:54:24.648979 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75
[0m23:54:24.652672 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75"
[0m23:54:24.653625 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75
[0m23:54:24.656041 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75"
[0m23:54:24.657175 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75"
[0m23:54:24.657865 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75: BEGIN
[0m23:54:24.658345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:24.761099 [debug] [Thread-1 (]: SQL status: BEGIN in 0.103 seconds
[0m23:54:24.761640 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75"
[0m23:54:24.762079 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ordered_at
from "dbt"."test"."stg_jaffle_shop__orders"
where ordered_at is null



      
    ) dbt_internal_test
[0m23:54:24.924587 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.162 seconds
[0m23:54:24.927850 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75: ROLLBACK
[0m23:54:24.929162 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75: Close
[0m23:54:24.929978 [info ] [Thread-1 (]: 3 of 6 PASS not_null_stg_jaffle_shop__orders_ordered_at ........................ [[32mPASS[0m in 0.28s]
[0m23:54:24.930787 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75
[0m23:54:24.931308 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9
[0m23:54:24.931900 [info ] [Thread-1 (]: 4 of 6 START test not_null_stg_jaffle_shop__orders_store_id .................... [RUN]
[0m23:54:24.932441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_jaffle_shop__orders_ordered_at.a26cbabb75, now test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9)
[0m23:54:24.932844 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9
[0m23:54:24.936565 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9"
[0m23:54:24.937501 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9
[0m23:54:24.939436 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9"
[0m23:54:24.940378 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9"
[0m23:54:24.940803 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9: BEGIN
[0m23:54:24.941183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:25.048291 [debug] [Thread-1 (]: SQL status: BEGIN in 0.107 seconds
[0m23:54:25.048787 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9"
[0m23:54:25.049158 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_id
from "dbt"."test"."stg_jaffle_shop__orders"
where store_id is null



      
    ) dbt_internal_test
[0m23:54:25.071285 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.022 seconds
[0m23:54:25.072866 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9: ROLLBACK
[0m23:54:25.074118 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9: Close
[0m23:54:25.074803 [info ] [Thread-1 (]: 4 of 6 PASS not_null_stg_jaffle_shop__orders_store_id .......................... [[32mPASS[0m in 0.14s]
[0m23:54:25.075627 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9
[0m23:54:25.076150 [debug] [Thread-1 (]: Began running node test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__id__ref_stg_jaffle_shop__customers_.f57e5d6d01
[0m23:54:25.076793 [info ] [Thread-1 (]: 5 of 6 START test relationships_stg_jaffle_shop__orders_customer_id__id__ref_stg_jaffle_shop__customers_  [RUN]
[0m23:54:25.077365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_jaffle_shop__orders_store_id.51a4b1edd9, now test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__id__ref_stg_jaffle_shop__customers_.f57e5d6d01)
[0m23:54:25.077925 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__id__ref_stg_jaffle_shop__customers_.f57e5d6d01
[0m23:54:25.083319 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__id__ref_stg_jaffle_shop__customers_.f57e5d6d01"
[0m23:54:25.084427 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__id__ref_stg_jaffle_shop__customers_.f57e5d6d01
[0m23:54:25.086520 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__id__ref_stg_jaffle_shop__customers_.f57e5d6d01"
[0m23:54:25.087750 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__id__ref_stg_jaffle_shop__customers_.f57e5d6d01"
[0m23:54:25.088227 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__id__ref_stg_jaffle_shop__customers_.f57e5d6d01: BEGIN
[0m23:54:25.088632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:25.205345 [debug] [Thread-1 (]: SQL status: BEGIN in 0.117 seconds
[0m23:54:25.205840 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__id__ref_stg_jaffle_shop__customers_.f57e5d6d01"
[0m23:54:25.206237 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__id__ref_stg_jaffle_shop__customers_.f57e5d6d01: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__id__ref_stg_jaffle_shop__customers_.f57e5d6d01"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "dbt"."test"."stg_jaffle_shop__orders"
    where customer_id is not null
),

parent as (
    select id as to_field
    from "dbt"."test"."stg_jaffle_shop__customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m23:54:25.409382 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.203 seconds
[0m23:54:25.410976 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__id__ref_stg_jaffle_shop__customers_.f57e5d6d01: ROLLBACK
[0m23:54:25.411822 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__id__ref_stg_jaffle_shop__customers_.f57e5d6d01: Close
[0m23:54:25.412717 [info ] [Thread-1 (]: 5 of 6 PASS relationships_stg_jaffle_shop__orders_customer_id__id__ref_stg_jaffle_shop__customers_  [[32mPASS[0m in 0.34s]
[0m23:54:25.413624 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__id__ref_stg_jaffle_shop__customers_.f57e5d6d01
[0m23:54:25.414139 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635
[0m23:54:25.414691 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_jaffle_shop__orders_id ............................ [RUN]
[0m23:54:25.415247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_jaffle_shop__orders_customer_id__id__ref_stg_jaffle_shop__customers_.f57e5d6d01, now test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635)
[0m23:54:25.415764 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635
[0m23:54:25.422772 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635"
[0m23:54:25.423738 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635
[0m23:54:25.425633 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635"
[0m23:54:25.426573 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635"
[0m23:54:25.426976 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635: BEGIN
[0m23:54:25.427332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:54:25.535767 [debug] [Thread-1 (]: SQL status: BEGIN in 0.108 seconds
[0m23:54:25.536264 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635"
[0m23:54:25.536640 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dbt"."test"."stg_jaffle_shop__orders"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:54:25.602423 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.065 seconds
[0m23:54:25.603974 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635: ROLLBACK
[0m23:54:25.604741 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635: Close
[0m23:54:25.605611 [info ] [Thread-1 (]: 6 of 6 PASS unique_stg_jaffle_shop__orders_id .................................. [[32mPASS[0m in 0.19s]
[0m23:54:25.606553 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635
[0m23:54:25.607994 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:25.608396 [debug] [MainThread]: On master: BEGIN
[0m23:54:25.608668 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:54:25.723335 [debug] [MainThread]: SQL status: BEGIN in 0.115 seconds
[0m23:54:25.723843 [debug] [MainThread]: On master: COMMIT
[0m23:54:25.724134 [debug] [MainThread]: Using postgres connection "master"
[0m23:54:25.724408 [debug] [MainThread]: On master: COMMIT
[0m23:54:25.724955 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:54:25.725311 [debug] [MainThread]: On master: Close
[0m23:54:25.725750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:54:25.726049 [debug] [MainThread]: Connection 'list_dbt_test' was properly closed.
[0m23:54:25.726338 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_jaffle_shop__orders_id.2339d85635' was properly closed.
[0m23:54:25.726718 [info ] [MainThread]: 
[0m23:54:25.727111 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 1.96 seconds (1.96s).
[0m23:54:25.729138 [debug] [MainThread]: Command end result
[0m23:54:25.757363 [info ] [MainThread]: 
[0m23:54:25.757867 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:54:25.758230 [info ] [MainThread]: 
[0m23:54:25.758614 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:54:25.759856 [debug] [MainThread]: Command `cli test` succeeded at 23:54:25.759681 after 3.32 seconds
[0m23:54:25.760276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184948A5440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001849434D770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001849492E2B0>]}
[0m23:54:25.760634 [debug] [MainThread]: Flushing usage events
